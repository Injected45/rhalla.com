import{g as E,y as M,x as j,l as u,c as n,a as t,e as K,q as y,j as e,s as w,v as C,z as N,t as i,n as k,F as $,r as S,o,E as U,_ as z}from"./BL0a6ohr.js";import{u as D}from"./to1ZvZyh.js";const F={class:"mg-page"},G={class:"container"},P={class:"mg-form-card"},R={key:0,class:"mg-step"},q={class:"mg-form-group"},L={key:0,class:"mg-error",style:{display:"block"}},A=["disabled"],H={key:1,class:"mg-step"},J={class:"mg-otp-wrapper"},Q=["onUpdate:modelValue","onInput","onKeydown"],W={key:0,class:"mg-error",style:{display:"block","text-align":"center"}},X={class:"mg-btn-group"},Y=["disabled"],Z={key:2,class:"mg-step"},tt={key:0,class:"table-wrapper"},st={class:"mg-results-table"},et={key:1,class:"mg-no-results"},at=E({__name:"track",setup(lt){M({title:"تتبع طلب موني جرام | الرحالة للصرافة",description:"تتبع حالة طلب تحويل موني جرام MoneyGram الخاص بك بسهولة"}),D();const x=j().public.apiBase,r=u(1),c=u(""),p=u(""),m=u(!1),h=u(""),d=u(["","","",""]),_=u([]),v=u(""),g=u(!1),b=u([]),V=async()=>{if(!c.value){p.value="يرجى إدخال رقم الهاتف";return}m.value=!0,p.value="";try{const l=await $fetch(`${x}/moneygram/track`,{method:"POST",body:{phone:c.value}});l.success&&(h.value=l.token,r.value=2)}catch(l){p.value=l.data?.message||"لم يتم العثور على طلبات بهذا الرقم."}finally{m.value=!1}},B=l=>{d.value[l]&&l<3&&_.value[l+1]?.focus()},I=(l,s)=>{!d.value[l]&&l>0&&_.value[l-1]?.focus()},O=async()=>{const l=d.value.join("");if(l.length!==4){v.value="يرجى إدخال الرمز كاملاً";return}g.value=!0,v.value="";try{const s=await $fetch(`${x}/moneygram/verify-tracking-otp`,{method:"POST",body:{token:h.value,otp:l}});s.success&&(b.value=s.transfers,r.value=3)}catch(s){v.value=s.data?.message||"رمز التحقق غير صحيح"}finally{g.value=!1}},T=()=>{r.value=1,c.value="",d.value=["","","",""],b.value=[],h.value=""};return(l,s)=>(o(),n("div",F,[t("div",G,[s[10]||(s[10]=K('<div class="mg-header" data-v-a017225f><div class="mg-badge" data-v-a017225f><i class="fas fa-search-location" data-v-a017225f></i><span data-v-a017225f>موني جرام</span></div><h1 class="mg-title" data-v-a017225f>تتبع <span class="gradient-text mg-color" data-v-a017225f>طلب التحويل</span></h1><p class="mg-subtitle" data-v-a017225f>أدخل رقم هاتفك للبحث عن طلبات موني جرام الخاصة بك</p></div>',1)),t("div",P,[e(r)===1?(o(),n("div",R,[t("div",q,[s[2]||(s[2]=t("label",{class:"mg-label"},"رقم الهاتف",-1)),w(t("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>N(c)?c.value=a:null),type:"tel",class:"mg-input",placeholder:"أدخل رقم هاتفك"},null,512),[[C,e(c)]]),s[3]||(s[3]=t("p",{class:"mg-hint"},"نفس الرقم المستخدم في طلب التحويل (ليبيا أو مصر)",-1)),e(p)?(o(),n("div",L,i(e(p)),1)):y("",!0)]),t("button",{type:"button",class:"mg-btn mg-btn-primary",onClick:V,disabled:e(m)},[t("i",{class:k(e(m)?"fas fa-spinner fa-spin":"fas fa-search")},null,2),t("span",null,i(e(m)?"جاري البحث...":"بحث"),1)],8,A)])):y("",!0),e(r)===2?(o(),n("div",H,[s[5]||(s[5]=t("p",null,"تم إرسال رمز التحقق إلى رقم هاتفك عبر الواتساب",-1)),t("div",J,[(o(),n($,null,S(4,a=>w(t("input",{key:a,ref_for:!0,ref:f=>e(_)[a-1]=f,"onUpdate:modelValue":f=>e(d)[a-1]=f,type:"text",class:"mg-otp-input",maxlength:"1",onInput:f=>B(a-1),onKeydown:U(f=>I(a-1),["backspace"])},null,40,Q),[[C,e(d)[a-1]]])),64))]),e(v)?(o(),n("div",W,i(e(v)),1)):y("",!0),t("div",X,[t("button",{type:"button",class:"mg-btn mg-btn-primary",onClick:O,disabled:e(g)},[t("i",{class:k(e(g)?"fas fa-spinner fa-spin":"fas fa-check")},null,2),t("span",null,i(e(g)?"جاري التحقق...":"تأكيد"),1)],8,Y),t("button",{type:"button",class:"mg-btn mg-btn-outline",onClick:s[1]||(s[1]=a=>r.value=1)},[...s[4]||(s[4]=[t("span",null,"رجوع",-1)])])])])):y("",!0),e(r)===3?(o(),n("div",Z,[s[9]||(s[9]=t("h3",{style:{"margin-bottom":"20px",display:"flex","align-items":"center","justify-content":"center",gap:"10px"}},[t("i",{class:"fas fa-list"}),t("span",null,"طلباتك (MoneyGram)")],-1)),e(b).length>0?(o(),n("div",tt,[t("table",st,[s[6]||(s[6]=t("thead",null,[t("tr",null,[t("th",null,"رقم التتبع"),t("th",null,"اسم المستلم"),t("th",null,"المبلغ"),t("th",null,"الحالة"),t("th",null,"التاريخ")])],-1)),t("tbody",null,[(o(!0),n($,null,S(e(b),a=>(o(),n("tr",{key:a.tracking_code},[t("td",null,i(a.tracking_code),1),t("td",null,i(a.receiver_name),1),t("td",null,"$"+i(a.amount),1),t("td",null,[t("span",{class:k(["mg-status-badge","mg-status-"+a.status_class])},i(a.status),3)]),t("td",null,i(a.date),1)]))),128))])])])):(o(),n("div",et,[...s[7]||(s[7]=[t("i",{class:"fas fa-inbox"},null,-1),t("p",null,"لا توجد طلبات مرتبطة بهذا الرقم",-1)])])),t("div",{class:"mg-btn-group",style:{"margin-top":"30px"}},[t("button",{type:"button",class:"mg-btn mg-btn-outline",onClick:T},[...s[8]||(s[8]=[t("i",{class:"fas fa-arrow-right"},null,-1),t("span",null,"بحث جديد",-1)])])])])):y("",!0)])])]))}}),it=z(at,[["__scopeId","data-v-a017225f"]]);export{it as default};
