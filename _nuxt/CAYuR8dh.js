import{H as c,z as n}from"./ZYNTWoyr.js";const d=c("currency",{state:()=>({internalCurrencies:[],externalCurrencies:[],internalLastUpdated:"",externalLastUpdated:"",featuredCurrencies:[],featuredLastUpdated:"",loading:!1,error:null,hasFetched:!1}),actions:{async fetchCurrencies(t=!1){if(this.hasFetched&&!t)return;this.loading=!0,this.error=null;const r=n(),i=r.public.useFeaturedCurrencies,a=r.public.apiBase;try{if(i){const e=await $fetch(`${a}/currency-prices/featured`);e.success&&(this.featuredCurrencies=e.data,this.featuredLastUpdated=e.last_updated,this.externalCurrencies=e.data,this.externalLastUpdated=e.last_updated)}else{const[e,s]=await Promise.all([$fetch(`${a}/currency-prices/internal`),$fetch(`${a}/currency-prices/external`)]);e.success&&(this.internalCurrencies=e.data,this.internalLastUpdated=e.last_updated),s.success&&(this.externalCurrencies=s.data,this.externalLastUpdated=s.last_updated)}this.hasFetched=!0}catch(e){this.error="فشل في تحميل أسعار العملات",console.error("Currency fetch error:",e)}finally{this.loading=!1}},async refreshCurrencies(){await this.fetchCurrencies(!0)}},getters:{lastUpdated:t=>n().public.useFeaturedCurrencies?t.featuredLastUpdated:t.externalLastUpdated||t.internalLastUpdated}});export{d as u};
