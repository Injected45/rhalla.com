import{h as A,E as K,y as L,z as R,i as o,k as j,D as C,c as d,a as s,l as k,f as G,A as J,B as r,d as i,C as f,m as t,I as S,F,r as I,t as y,n as N,b as Z,w as H,e as Q,o as p,K as W,_ as X}from"./BjY1POE0.js";const Y={class:"wu-page"},ss={class:"container"},es={class:"wu-form-card"},ts={class:"wu-form-row"},ls={class:"wu-form-group"},as={class:"wu-form-group"},ns={class:"wu-form-row"},os={class:"wu-form-group"},is={class:"wu-form-group"},us={class:"wu-form-row"},rs={class:"wu-form-group"},ds={class:"wu-form-group"},ps={class:"wu-file-wrapper"},cs={key:0,class:"wu-preview-container show"},fs=["src"],vs={class:"wu-form-row"},ms={class:"wu-form-group"},ws={class:"wu-form-group"},bs={class:"wu-form-row"},ys={class:"wu-form-group"},_s={key:0,class:"wu-shimmer-select"},gs=["value"],ks={class:"wu-form-group"},qs={class:"wu-form-row"},xs={class:"wu-form-group"},Vs={class:"wu-amount-wrapper"},hs={class:"wu-submit-wrapper"},Cs=["disabled"],Us={key:0,class:"wu-modal-overlay show"},Bs={class:"wu-modal"},$s={class:"wu-modal-body"},Ms={class:"wu-otp-wrapper"},Ss=["onUpdate:modelValue","onInput","onKeydown"],Fs={key:0,class:"wu-modal-error",style:{display:"block"}},Is=["disabled"],Ns={key:1,class:"wu-modal-overlay show"},Os={class:"wu-modal"},Ds={class:"wu-modal-body",style:{"padding-top":"50px"}},Es={class:"wu-tracking-code"},zs=A({__name:"transfer",setup(Ps){K({title:"طلب تحويل ويسترن يونيون | الرحالة للصرافة",description:"قم بإرسال الأموال عبر ويسترن يونيون من ليبيا إلى أي مكان في العالم"});const{error:q}=L(),n=R({sender_name:"",sender_country:"",sender_city:"",national_id:"",sender_phone:"",receiver_name_ar:"",receiver_name_en:"",receiver_country:"",receiver_phone:"",amount:""}),_=o(null),g=o(""),U=o([]),x=o(!0),v=o(!1),B=o(""),V=o(!1),m=o(["","","",""]),h=o([]),w=o(""),b=o(!1),$=o(!1),M=o("");j(async()=>{x.value=!0;try{const a=C(),e=await $fetch(`${a.public.apiBase}/western-union/countries`);U.value=e.countries}catch(a){console.error("Failed to load countries",a)}finally{x.value=!1}});const O=a=>{const u=a.target.files?.[0];if(u){if(u.size>5*1024*1024){q("حجم الصورة يجب أن يكون أقل من 5MB");return}_.value=u;const l=new FileReader;l.onload=c=>{g.value=c.target?.result},l.readAsDataURL(u)}},D=()=>{_.value=null,g.value="";const a=document.getElementById("passport_image");a&&(a.value="")},E=async()=>{if(!_.value){q("يرجى رفع صورة الجواز");return}v.value=!0;try{const a=new FormData;Object.entries(n).forEach(([l,c])=>{a.append(l,c)}),a.append("passport_image",_.value);const e=C(),u=await $fetch(`${e.public.apiBase}/western-union/transfer`,{method:"POST",body:a});u.success&&(B.value=u.token,V.value=!0)}catch(a){q(a.data?.message||"حدث خطأ. يرجى المحاولة مرة أخرى.")}finally{v.value=!1}},z=a=>{m.value[a]&&a<3&&h.value[a+1]?.focus()},P=(a,e)=>{!m.value[a]&&a>0&&h.value[a-1]?.focus()},T=async()=>{const a=m.value.join("");if(a.length!==4){w.value="يرجى إدخال الرمز كاملاً";return}b.value=!0,w.value="";try{const e=C(),u=await $fetch(`${e.public.apiBase}/western-union/verify-otp`,{method:"POST",body:{token:B.value,otp:a}});u.success&&(V.value=!1,M.value=u.tracking_code,$.value=!0)}catch(e){w.value=e.data?.message||"رمز التحقق غير صحيح"}finally{b.value=!1}};return(a,e)=>{const u=Q;return p(),d("div",Y,[s("div",ss,[e[33]||(e[33]=G('<div class="wu-header" data-v-264398bf><div class="wu-badge" data-v-264398bf><i class="fas fa-money-bill-transfer" data-v-264398bf></i><span data-v-264398bf>ويسترن يونيون</span></div><h1 class="wu-title" data-v-264398bf>طلب تحويل <span class="gradient-text" data-v-264398bf>ويسترن يونيون</span></h1><p class="wu-subtitle" data-v-264398bf>يرجى ملء جميع البيانات بشكل صحيح لإتمام عملية التحويل</p></div>',1)),s("div",es,[s("form",{onSubmit:J(E,["prevent"])},[e[30]||(e[30]=s("h3",{class:"wu-section-title"},[s("i",{class:"fas fa-user"}),s("span",null,"معلومات الراسل")],-1)),s("div",ts,[s("div",ls,[e[10]||(e[10]=s("label",{class:"wu-label"},[i("اسم الراسل "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t(n).sender_name=l),type:"text",class:"wu-input",required:""},null,512),[[f,t(n).sender_name]])]),s("div",as,[e[12]||(e[12]=s("label",{class:"wu-label"},[i("بلد الراسل "),s("span",{class:"required"},"*")],-1)),r(s("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>t(n).sender_country=l),class:"wu-select",required:""},[...e[11]||(e[11]=[s("option",{value:""},"اختر البلد",-1),s("option",{value:"ليبيا"},"ليبيا",-1)])],512),[[S,t(n).sender_country]])])]),s("div",ns,[s("div",os,[e[13]||(e[13]=s("label",{class:"wu-label"},[i("المدينة "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t(n).sender_city=l),type:"text",class:"wu-input",required:""},null,512),[[f,t(n).sender_city]])]),s("div",is,[e[14]||(e[14]=s("label",{class:"wu-label"},[i("الرقم الوطني (12 رقم) "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t(n).national_id=l),type:"text",class:"wu-input",maxlength:"12",pattern:"[0-9]{12}",required:""},null,512),[[f,t(n).national_id]])])]),s("div",us,[s("div",rs,[e[15]||(e[15]=s("label",{class:"wu-label"},[i("رقم هاتف الراسل "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>t(n).sender_phone=l),type:"tel",class:"wu-input",placeholder:"مثال: 0912345678",required:""},null,512),[[f,t(n).sender_phone]]),e[16]||(e[16]=s("span",{class:"wu-hint"},"أرقام ليبيا أو مصر فقط - سيتم إرسال رمز التحقق عبر الواتساب",-1))]),s("div",ds,[e[19]||(e[19]=s("label",{class:"wu-label"},[i("صورة الجواز "),s("span",{class:"required"},"*")],-1)),s("div",ps,[s("input",{type:"file",class:"wu-file-input",id:"passport_image",onChange:O,accept:"image/*",required:""},null,32),e[17]||(e[17]=s("label",{for:"passport_image",class:"wu-file-label"},[s("i",{class:"fas fa-cloud-upload-alt"}),s("span",{class:"wu-file-text"},"اضغط لرفع صورة الجواز")],-1))]),e[20]||(e[20]=s("span",{class:"wu-hint"},"الصيغ المسموحة: JPG, PNG - الحد الأقصى: 5MB",-1)),t(g)?(p(),d("div",cs,[s("img",{src:t(g),class:"wu-preview-img",alt:"معاينة"},null,8,fs),s("button",{type:"button",class:"wu-preview-remove",onClick:D},[...e[18]||(e[18]=[s("i",{class:"fas fa-times"},null,-1)])])])):k("",!0)])]),e[31]||(e[31]=s("hr",{class:"wu-divider"},null,-1)),e[32]||(e[32]=s("h3",{class:"wu-section-title",style:{color:"#00B17A"}},[s("i",{class:"fas fa-user-check"}),s("span",null,"معلومات المستلم")],-1)),s("div",vs,[s("div",ms,[e[21]||(e[21]=s("label",{class:"wu-label"},[i("اسم المستلم بالكامل (بالعربي) "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>t(n).receiver_name_ar=l),type:"text",class:"wu-input",required:""},null,512),[[f,t(n).receiver_name_ar]])]),s("div",ws,[e[22]||(e[22]=s("label",{class:"wu-label"},[i("اسم المستلم بالكامل (بالإنجليزي) "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>t(n).receiver_name_en=l),type:"text",class:"wu-input",pattern:"[a-zA-Z\\s]+",required:""},null,512),[[f,t(n).receiver_name_en]]),e[23]||(e[23]=s("span",{class:"wu-hint"},"حروف إنجليزية فقط",-1))])]),s("div",bs,[s("div",ys,[e[26]||(e[26]=s("label",{class:"wu-label"},[i("بلد المستلم "),s("span",{class:"required"},"*")],-1)),t(x)?(p(),d("div",_s,[...e[24]||(e[24]=[s("div",{class:"shimmer-animation"},null,-1)])])):r((p(),d("select",{key:1,"onUpdate:modelValue":e[7]||(e[7]=l=>t(n).receiver_country=l),class:"wu-select",required:""},[e[25]||(e[25]=s("option",{value:""},"اختر البلد",-1)),(p(!0),d(F,null,I(t(U),l=>(p(),d("option",{key:l,value:l},y(l),9,gs))),128))],512)),[[S,t(n).receiver_country]])]),s("div",ks,[e[27]||(e[27]=s("label",{class:"wu-label"},[i("رقم هاتف المستلم "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>t(n).receiver_phone=l),type:"tel",class:"wu-input",required:""},null,512),[[f,t(n).receiver_phone]])])]),s("div",qs,[s("div",xs,[e[29]||(e[29]=s("label",{class:"wu-label"},[i("المبلغ بالدولار ($) "),s("span",{class:"required"},"*")],-1)),s("div",Vs,[e[28]||(e[28]=s("span",{class:"wu-amount-prefix"},"$",-1)),r(s("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>t(n).amount=l),type:"number",class:"wu-input wu-amount-input",min:"1",step:"0.01",required:""},null,512),[[f,t(n).amount]])])])]),s("div",hs,[s("button",{type:"submit",class:"wu-submit-btn",disabled:t(v)},[s("span",null,y(t(v)?"جاري الإرسال...":"التالي"),1),s("i",{class:N(t(v)?"fas fa-spinner fa-spin":"fas fa-arrow-left")},null,2)],8,Cs)])],32)])]),t(V)?(p(),d("div",Us,[s("div",Bs,[e[35]||(e[35]=s("div",{class:"wu-modal-header"},[s("i",{class:"fas fa-shield-halved"}),s("h3",null,"التحقق من رقم الهاتف")],-1)),s("div",$s,[e[34]||(e[34]=s("p",null,[i("تم إرسال رمز التحقق إلى رقم هاتفك عبر الواتساب"),s("br"),i("أدخل الرمز المكون من 4 أرقام")],-1)),s("div",Ms,[(p(),d(F,null,I(4,l=>r(s("input",{key:l,ref_for:!0,ref:c=>t(h)[l-1]=c,"onUpdate:modelValue":c=>t(m)[l-1]=c,type:"text",class:"wu-otp-input",maxlength:"1",onInput:c=>z(l-1),onKeydown:W(c=>P(l-1),["backspace"])},null,40,Ss),[[f,t(m)[l-1]]])),64))]),t(w)?(p(),d("div",Fs,y(t(w)),1)):k("",!0),s("button",{type:"button",class:"wu-submit-btn",onClick:T,disabled:t(b)},[s("i",{class:N(t(b)?"fas fa-spinner fa-spin":"fas fa-check")},null,2),s("span",null,y(t(b)?"جاري التحقق...":"تأكيد"),1)],8,Is)])])])):k("",!0),t($)?(p(),d("div",Ns,[s("div",Os,[s("div",Ds,[e[37]||(e[37]=s("div",{class:"wu-success-icon"},[s("i",{class:"fas fa-check-circle"})],-1)),e[38]||(e[38]=s("h2",{style:{"margin-bottom":"10px"}},"تم تقديم طلبك بنجاح!",-1)),e[39]||(e[39]=s("p",null,"رقم التتبع الخاص بك:",-1)),s("div",Es,y(t(M)),1),e[40]||(e[40]=s("p",{style:{"font-size":"0.9rem"}},"احتفظ بهذا الرقم لتتبع طلبك",-1)),Z(u,{to:"/",class:"wu-submit-btn",style:{"margin-top":"20px","text-decoration":"none"}},{default:H(()=>[...e[36]||(e[36]=[s("i",{class:"fas fa-home"},null,-1),s("span",null,"العودة للرئيسية",-1)])]),_:1})])])])):k("",!0)])}}}),As=X(zs,[["__scopeId","data-v-264398bf"]]);export{As as default};
