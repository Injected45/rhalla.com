import{h as A,E as H,i as r,c as i,a as s,l as b,b as M,w as R,d as p,n as v,m as l,B as q,C as I,K,G as S,F as C,r as j,t as n,D as J,e as Q,o as d,_ as W}from"./aRXtVBIH.js";const X={class:"transfer-inquiry-page"},Z={class:"container"},ss={class:"page-header"},ts={class:"progress-steps"},ls={key:0,class:"step-content"},as={class:"form-card"},es={class:"form-group"},ns=["disabled"],os={key:0},is={key:1},ds={key:1,class:"step-content"},rs={class:"form-card"},us={class:"phones-list"},ps={dir:"ltr"},vs={class:"form-group"},cs=["disabled"],fs={key:0},bs={key:1},_s={key:2,class:"step-content"},ms={class:"form-card"},ys={class:"otp-inputs"},gs=["onUpdate:modelValue","onInput","onKeydown"],ks=["disabled"],ws={key:0},hs={key:1},Cs={key:3,class:"step-content"},Ts={class:"result-card"},$s={class:"result-header"},xs={class:"result-details"},Bs={class:"detail-row"},Vs={class:"value"},Ds={class:"detail-row"},Ns={class:"value code"},Os={class:"detail-row"},qs={class:"value"},Is={class:"detail-row"},Ks={class:"datetime-value"},Ls={class:"date-part"},Ps={class:"time-part"},Fs={class:"detail-row"},Us={class:"value"},Ms={class:"detail-row"},Rs={class:"value"},Ss={class:"detail-row highlight"},js={class:"value amount"},Es={class:"detail-row"},zs={key:0,class:"detail-row"},Gs={class:"datetime-value"},Ys={class:"date-part"},As={class:"time-part"},Hs={class:"detail-row"},Js={class:"value code"},Qs={class:"detail-row"},Ws={class:"detail-row"},Xs={class:"value"},Zs={class:"detail-row"},st={class:"value"},tt={class:"detail-row highlight"},lt={class:"value amount"},at={class:"detail-row highlight"},et={class:"value amount"},nt={class:"detail-row"},ot={class:"datetime-value"},it={class:"date-part"},dt={key:0,class:"detail-row"},rt={class:"value"},ut={key:1,class:"detail-row"},pt={class:"value"},vt={class:"result-actions"},ct={key:4,class:"error-toast"},ft=A({__name:"transfer-inquiry",setup(bt){H({title:"استعلام عن حوالة | شركة الرحالة للصرافة والخدمات المالية",description:"تتبع حالة حوالتك المالية (الداخلية والخارجية) مباشرة عبر موقع شركة الرحالة للصرافة. خدمة تتبع سريعة وآمنة باستخدام رقم الحوالة."});const T=J(),o=r(1),c=r(!1),f=r(""),_=r(""),$=r(""),x=r([]),m=r(""),B=r(""),h=r(""),V=r(""),y=r(["","","",""]),D=r([]),e=r(null),k=r(""),N=r(""),L=async()=>{if(_.value){c.value=!0,f.value="";try{const a=await $fetch(`${T.public.apiBase}/transfer-inquiry/search`,{method:"POST",body:{code:_.value}});a.success&&($.value=a.token,x.value=a.phones,o.value=2)}catch(a){f.value=a.data?.message||"لم يتم العثور على حوالة بهذا الرقم"}finally{c.value=!1}}},P=async()=>{if(m.value){c.value=!0,f.value="";try{const a=await $fetch(`${T.public.apiBase}/transfer-inquiry/send-otp`,{method:"POST",body:{token:$.value,phone:m.value}});a.success&&(B.value=a.token,h.value=a.role,V.value=a.role_label,o.value=3)}catch(a){f.value=a.data?.message||"رقم الهاتف غير مطابق"}finally{c.value=!1}}},E=async()=>{const a=y.value.join("");if(a.length===4){c.value=!0,f.value="";try{const t=await $fetch(`${T.public.apiBase}/transfer-inquiry/verify`,{method:"POST",body:{token:B.value,otp:a}});t.success&&(e.value=t.transfer,k.value=t.transfer_type||"internal",N.value=t.transfer_type_label||"حوالة داخلية",o.value=4)}catch(t){f.value=t.data?.message||"رمز التحقق غير صحيح"}finally{c.value=!1}}},z=a=>{y.value[a]&&a<3&&D.value[a+1]?.focus()},G=(a,t)=>{!y.value[a]&&a>0&&D.value[a-1]?.focus()},O=a=>{if(!a)return"";try{return a.split(" ")[0]}catch{return a}},F=a=>{if(!a)return"";try{const t=a.split(" ")[1];if(!t)return"";const w=t.split(":");return`${w[0]}:${w[1]}`}catch{return""}},U=()=>{o.value>1&&(o.value--,f.value="")},Y=()=>{o.value=1,_.value="",$.value="",x.value=[],m.value="",B.value="",h.value="",V.value="",y.value=["","","",""],e.value=null,k.value="",N.value="",f.value=""};return(a,t)=>{const w=Q;return d(),i("div",X,[s("div",Z,[s("div",ss,[M(w,{to:"/",class:"back-link"},{default:R(()=>[...t[3]||(t[3]=[s("i",{class:"fas fa-arrow-right"},null,-1),s("span",null,"العودة للرئيسية",-1)])]),_:1}),t[4]||(t[4]=s("h1",{class:"page-title"},[s("i",{class:"fas fa-search-dollar"}),p(" استعلام عن "),s("span",{class:"gradient-text"},"حوالة")],-1)),t[5]||(t[5]=s("p",{class:"page-subtitle"},"تحقق من حالة حوالتك بكل سهولة وأمان",-1))]),s("div",ts,[s("div",{class:v(["step",{active:l(o)>=1,completed:l(o)>1}])},[...t[6]||(t[6]=[s("div",{class:"step-number"},"1",-1),s("span",null,"رقم الحوالة",-1)])],2),s("div",{class:v(["step-line",{active:l(o)>1}])},null,2),s("div",{class:v(["step",{active:l(o)>=2,completed:l(o)>2}])},[...t[7]||(t[7]=[s("div",{class:"step-number"},"2",-1),s("span",null,"رقم الهاتف",-1)])],2),s("div",{class:v(["step-line",{active:l(o)>2}])},null,2),s("div",{class:v(["step",{active:l(o)>=3,completed:l(o)>3}])},[...t[8]||(t[8]=[s("div",{class:"step-number"},"3",-1),s("span",null,"التحقق",-1)])],2),s("div",{class:v(["step-line",{active:l(o)>3}])},null,2),s("div",{class:v(["step",{active:l(o)>=4}])},[...t[9]||(t[9]=[s("div",{class:"step-number"},"4",-1),s("span",null,"النتيجة",-1)])],2)]),l(o)===1?(d(),i("div",ls,[s("div",as,[t[11]||(t[11]=s("div",{class:"form-icon"},[s("i",{class:"fas fa-hashtag"})],-1)),t[12]||(t[12]=s("h2",null,"أدخل رقم الحوالة",-1)),t[13]||(t[13]=s("p",null,"أدخل رقم الحوالة المكون من أرقام للاستعلام عنها",-1)),s("div",es,[q(s("input",{"onUpdate:modelValue":t[0]||(t[0]=u=>S(_)?_.value=u:null),type:"text",placeholder:"مثال: 123456",class:"input-large",onKeyup:K(L,["enter"])},null,544),[[I,l(_)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!l(_)||l(c),onClick:L},[l(c)?(d(),i("span",is,[...t[10]||(t[10]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),p(" جاري البحث...",-1)])])):(d(),i("span",os,"بحث"))],8,ns)])])):b("",!0),l(o)===2?(d(),i("div",ds,[s("div",rs,[t[17]||(t[17]=s("div",{class:"form-icon success"},[s("i",{class:"fas fa-check"})],-1)),t[18]||(t[18]=s("h2",null,"تم العثور على الحوالة!",-1)),t[19]||(t[19]=s("p",null,"أدخل رقم هاتفك للتحقق من هويتك",-1)),s("div",us,[(d(!0),i(C,null,j(l(x),(u,g)=>(d(),i("div",{key:g,class:"phone-item"},[t[14]||(t[14]=s("i",{class:"fas fa-phone"},null,-1)),s("span",null,[p(n(u.label)+": ",1),s("span",ps,n(u.masked),1)])]))),128))]),s("div",vs,[q(s("input",{"onUpdate:modelValue":t[1]||(t[1]=u=>S(m)?m.value=u:null),type:"tel",placeholder:"أدخل رقم هاتفك الكامل",class:"input-large",dir:"ltr",onKeyup:K(P,["enter"])},null,544),[[I,l(m)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!l(m)||l(c),onClick:P},[l(c)?(d(),i("span",bs,[...t[15]||(t[15]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),p(" جاري الإرسال...",-1)])])):(d(),i("span",fs,"إرسال رمز التحقق"))],8,cs),s("button",{class:"btn btn-outline btn-sm",onClick:U},[...t[16]||(t[16]=[s("i",{class:"fas fa-arrow-right"},null,-1),p(" رجوع ",-1)])])])])):b("",!0),l(o)===3?(d(),i("div",_s,[s("div",ms,[t[22]||(t[22]=s("div",{class:"form-icon"},[s("i",{class:"fab fa-whatsapp"})],-1)),t[23]||(t[23]=s("h2",null,"أدخل رمز التحقق",-1)),t[24]||(t[24]=s("p",null,"تم إرسال رمز مكون من 4 أرقام إلى واتساب",-1)),s("div",{class:v(["role-badge",l(h)])},[s("i",{class:v(l(h)==="sender"?"fas fa-paper-plane":"fas fa-inbox")},null,2),s("span",null,n(l(V)),1)],2),s("div",ys,[(d(),i(C,null,j(4,u=>q(s("input",{key:u,ref_for:!0,ref:g=>l(D)[u-1]=g,"onUpdate:modelValue":g=>l(y)[u-1]=g,type:"text",maxlength:"1",class:"otp-input",onInput:g=>z(u-1),onKeydown:K(g=>G(u-1),["backspace"])},null,40,gs),[[I,l(y)[u-1]]])),64))]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:l(y).join("").length!==4||l(c),onClick:E},[l(c)?(d(),i("span",hs,[...t[20]||(t[20]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),p(" جاري التحقق...",-1)])])):(d(),i("span",ws,"تحقق"))],8,ks),s("button",{class:"btn btn-outline btn-sm",onClick:U},[...t[21]||(t[21]=[s("i",{class:"fas fa-arrow-right"},null,-1),p(" رجوع ",-1)])])])])):b("",!0),l(o)===4?(d(),i("div",Cs,[s("div",Ts,[s("div",$s,[s("div",{class:v(["result-icon",l(e)?.status_class])},[...t[25]||(t[25]=[s("i",{class:"fas fa-receipt"},null,-1)])],2),t[26]||(t[26]=s("h2",null,"تفاصيل الحوالة",-1)),s("div",{class:v(["transfer-type-badge",l(k)])},[s("i",{class:v(l(k)==="internal"?"fas fa-home":"fas fa-globe")},null,2),s("span",null,n(l(N)),1)],2)]),s("div",xs,[l(k)==="internal"?(d(),i(C,{key:0},[s("div",Bs,[t[27]||(t[27]=s("span",{class:"label"},"الفرع المرسل",-1)),s("span",Vs,n(l(e)?.branch_received),1)]),s("div",Ds,[t[28]||(t[28]=s("span",{class:"label"},"رقم الحوالة",-1)),s("span",Ns,n(l(e)?.code),1)]),s("div",Os,[t[29]||(t[29]=s("span",{class:"label"},"المرسل",-1)),s("span",qs,n(l(e)?.sender_name),1)]),s("div",Is,[t[32]||(t[32]=s("span",{class:"label"},"تاريخ الارسال",-1)),s("div",Ks,[s("span",Ls,[t[30]||(t[30]=s("i",{class:"far fa-calendar-alt"},null,-1)),p(" "+n(O(l(e)?.insert_date)),1)]),s("span",Ps,[t[31]||(t[31]=s("i",{class:"far fa-clock"},null,-1)),p(" "+n(F(l(e)?.insert_date)),1)])])]),s("div",Fs,[t[33]||(t[33]=s("span",{class:"label"},"تسليم في",-1)),s("span",Us,n(l(e)?.branch_delivered),1)]),s("div",Ms,[t[34]||(t[34]=s("span",{class:"label"},"المستلم",-1)),s("span",Rs,n(l(e)?.receiver_name),1)]),s("div",Ss,[t[35]||(t[35]=s("span",{class:"label"},"المبلغ",-1)),s("span",js,n(l(e)?.amount)+" د.ل",1)]),s("div",Es,[t[36]||(t[36]=s("span",{class:"label"},"حالة الحوالة",-1)),s("div",{class:v(["status-badge",l(e)?.status_class])},n(l(e)?.status),3)]),(Number(l(e)?.status_code)===2||Number(l(e)?.status_code)===3)&&l(e)?.received_date?(d(),i("div",zs,[t[39]||(t[39]=s("span",{class:"label"},"تاريخ التسليم",-1)),s("div",Gs,[s("span",Ys,[t[37]||(t[37]=s("i",{class:"far fa-calendar-alt"},null,-1)),p(" "+n(O(l(e)?.received_date)),1)]),s("span",As,[t[38]||(t[38]=s("i",{class:"far fa-clock"},null,-1)),p(" "+n(F(l(e)?.received_date)),1)])])])):b("",!0)],64)):(d(),i(C,{key:1},[s("div",Hs,[t[40]||(t[40]=s("span",{class:"label"},"رقم الحوالة",-1)),s("span",Js,n(l(e)?.code),1)]),s("div",Qs,[t[41]||(t[41]=s("span",{class:"label"},"حالة الحوالة",-1)),s("div",{class:v(["status-badge",l(e)?.status_class])},n(l(e)?.status),3)]),s("div",Ws,[t[42]||(t[42]=s("span",{class:"label"},"المرسل",-1)),s("span",Xs,n(l(e)?.sender_name),1)]),s("div",Zs,[t[43]||(t[43]=s("span",{class:"label"},"المستلم",-1)),s("span",st,n(l(e)?.receiver_name),1)]),s("div",tt,[t[44]||(t[44]=s("span",{class:"label"},"المبلغ بالدينار الليبي",-1)),s("span",lt,n(l(e)?.amount_lyd)+" LYD",1)]),s("div",at,[t[45]||(t[45]=s("span",{class:"label"},"المبلغ الإجمالي",-1)),s("span",et,n(l(e)?.amount_total),1)]),s("div",nt,[t[47]||(t[47]=s("span",{class:"label"},"تاريخ الإرسال",-1)),s("div",ot,[s("span",it,[t[46]||(t[46]=s("i",{class:"far fa-calendar-alt"},null,-1)),p(" "+n(O(l(e)?.insert_date)),1)])])]),l(e)?.service_type?(d(),i("div",dt,[t[48]||(t[48]=s("span",{class:"label"},"نوع الخدمة",-1)),s("span",rt,n(l(e)?.service_type),1)])):b("",!0),l(e)?.country?(d(),i("div",ut,[t[49]||(t[49]=s("span",{class:"label"},"الدولة",-1)),s("span",pt,n(l(e)?.country),1)])):b("",!0)],64))]),s("div",vt,[s("button",{class:"btn btn-primary btn-lg",onClick:Y},[...t[50]||(t[50]=[s("i",{class:"fas fa-search"},null,-1),p(" استعلام جديد ",-1)])]),M(w,{to:"/",class:"btn btn-outline btn-lg"},{default:R(()=>[...t[51]||(t[51]=[s("i",{class:"fas fa-home"},null,-1),p(" الرئيسية ",-1)])]),_:1})])])])):b("",!0),l(f)?(d(),i("div",ct,[t[53]||(t[53]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),s("span",null,n(l(f)),1),s("button",{onClick:t[2]||(t[2]=u=>f.value="")},[...t[52]||(t[52]=[s("i",{class:"fas fa-times"},null,-1)])])])):b("",!0)])])}}}),mt=W(ft,[["__scopeId","data-v-66f4747f"]]);export{mt as default};
