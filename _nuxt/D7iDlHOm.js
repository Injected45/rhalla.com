import{h as A,E as H,i as r,c as i,a as s,l as b,b as M,w as R,d as u,n as v,m as l,B as I,C as K,K as L,G as S,F as C,r as j,t as n,D as J,e as Q,o as d,_ as W}from"./CAYCDIvW.js";const X={class:"transfer-inquiry-page"},Z={class:"container"},ss={class:"page-header"},ts={class:"progress-steps"},ls={key:0,class:"step-content"},as={class:"form-card"},es={class:"form-group"},ns=["disabled"],os={key:0},is={key:1},ds={key:1,class:"step-content"},rs={class:"form-card"},us={class:"phones-list"},ps={dir:"ltr"},vs={class:"form-group"},cs=["disabled"],fs={key:0},bs={key:1},_s={key:2,class:"step-content"},ms={class:"form-card"},ys={class:"otp-inputs"},ks=["onUpdate:modelValue","onInput","onKeydown"],gs=["disabled"],ws={key:0},hs={key:1},Cs={key:3,class:"step-content"},Ts={class:"result-card"},$s={class:"result-header"},xs={class:"result-details"},Bs={class:"detail-row"},Vs={class:"value"},Ds={class:"detail-row"},Ns={class:"value code"},Os={class:"detail-row"},qs={class:"value"},Is={class:"detail-row"},Ks={class:"datetime-value"},Ls={class:"date-part"},Ps={class:"time-part"},Fs={class:"detail-row"},Us={class:"value"},Ms={class:"detail-row"},Rs={class:"value"},Ss={class:"detail-row highlight"},js={class:"value amount"},Es={class:"detail-row"},zs={key:0,class:"detail-row"},Gs={class:"datetime-value"},Ys={class:"date-part"},As={class:"time-part"},Hs={class:"detail-row"},Js={class:"value code"},Qs={class:"detail-row"},Ws={class:"detail-row"},Xs={class:"value"},Zs={class:"detail-row"},st={class:"value"},tt={class:"detail-row highlight"},lt={class:"value amount"},at={class:"detail-row highlight"},et={class:"value amount"},nt={class:"detail-row"},ot={class:"datetime-value"},it={class:"date-part"},dt={class:"time-part"},rt={key:0,class:"detail-row"},ut={class:"value"},pt={key:1,class:"detail-row"},vt={class:"value"},ct={class:"result-actions"},ft={key:4,class:"error-toast"},bt=A({__name:"transfer-inquiry",setup(_t){H({title:"استعلام عن حوالة | شركة الرحالة للصرافة",description:"استعلم عن حوالتك المالية وتتبع حالتها بكل سهولة وأمان مع شركة الرحالة للصرافة"});const T=J(),o=r(1),c=r(!1),f=r(""),_=r(""),$=r(""),x=r([]),m=r(""),B=r(""),h=r(""),V=r(""),y=r(["","","",""]),D=r([]),a=r(null),g=r(""),N=r(""),P=async()=>{if(_.value){c.value=!0,f.value="";try{const e=await $fetch(`${T.public.apiBase}/transfer-inquiry/search`,{method:"POST",body:{code:_.value}});e.success&&($.value=e.token,x.value=e.phones,o.value=2)}catch(e){f.value=e.data?.message||"لم يتم العثور على حوالة بهذا الرقم"}finally{c.value=!1}}},F=async()=>{if(m.value){c.value=!0,f.value="";try{const e=await $fetch(`${T.public.apiBase}/transfer-inquiry/send-otp`,{method:"POST",body:{token:$.value,phone:m.value}});e.success&&(B.value=e.token,h.value=e.role,V.value=e.role_label,o.value=3)}catch(e){f.value=e.data?.message||"رقم الهاتف غير مطابق"}finally{c.value=!1}}},E=async()=>{const e=y.value.join("");if(e.length===4){c.value=!0,f.value="";try{const t=await $fetch(`${T.public.apiBase}/transfer-inquiry/verify`,{method:"POST",body:{token:B.value,otp:e}});t.success&&(a.value=t.transfer,g.value=t.transfer_type||"internal",N.value=t.transfer_type_label||"حوالة داخلية",o.value=4)}catch(t){f.value=t.data?.message||"رمز التحقق غير صحيح"}finally{c.value=!1}}},z=e=>{y.value[e]&&e<3&&D.value[e+1]?.focus()},G=(e,t)=>{!y.value[e]&&e>0&&D.value[e-1]?.focus()},O=e=>{if(!e)return"";try{return e.split(" ")[0]}catch{return e}},q=e=>{if(!e)return"";try{const t=e.split(" ")[1];if(!t)return"";const w=t.split(":");return`${w[0]}:${w[1]}`}catch{return""}},U=()=>{o.value>1&&(o.value--,f.value="")},Y=()=>{o.value=1,_.value="",$.value="",x.value=[],m.value="",B.value="",h.value="",V.value="",y.value=["","","",""],a.value=null,g.value="",N.value="",f.value=""};return(e,t)=>{const w=Q;return d(),i("div",X,[s("div",Z,[s("div",ss,[M(w,{to:"/",class:"back-link"},{default:R(()=>[...t[3]||(t[3]=[s("i",{class:"fas fa-arrow-right"},null,-1),s("span",null,"العودة للرئيسية",-1)])]),_:1}),t[4]||(t[4]=s("h1",{class:"page-title"},[s("i",{class:"fas fa-search-dollar"}),u(" استعلام عن "),s("span",{class:"gradient-text"},"حوالة")],-1)),t[5]||(t[5]=s("p",{class:"page-subtitle"},"تحقق من حالة حوالتك بكل سهولة وأمان",-1))]),s("div",ts,[s("div",{class:v(["step",{active:l(o)>=1,completed:l(o)>1}])},[...t[6]||(t[6]=[s("div",{class:"step-number"},"1",-1),s("span",null,"رقم الحوالة",-1)])],2),s("div",{class:v(["step-line",{active:l(o)>1}])},null,2),s("div",{class:v(["step",{active:l(o)>=2,completed:l(o)>2}])},[...t[7]||(t[7]=[s("div",{class:"step-number"},"2",-1),s("span",null,"رقم الهاتف",-1)])],2),s("div",{class:v(["step-line",{active:l(o)>2}])},null,2),s("div",{class:v(["step",{active:l(o)>=3,completed:l(o)>3}])},[...t[8]||(t[8]=[s("div",{class:"step-number"},"3",-1),s("span",null,"التحقق",-1)])],2),s("div",{class:v(["step-line",{active:l(o)>3}])},null,2),s("div",{class:v(["step",{active:l(o)>=4}])},[...t[9]||(t[9]=[s("div",{class:"step-number"},"4",-1),s("span",null,"النتيجة",-1)])],2)]),l(o)===1?(d(),i("div",ls,[s("div",as,[t[11]||(t[11]=s("div",{class:"form-icon"},[s("i",{class:"fas fa-hashtag"})],-1)),t[12]||(t[12]=s("h2",null,"أدخل رقم الحوالة",-1)),t[13]||(t[13]=s("p",null,"أدخل رقم الحوالة المكون من أرقام للاستعلام عنها",-1)),s("div",es,[I(s("input",{"onUpdate:modelValue":t[0]||(t[0]=p=>S(_)?_.value=p:null),type:"text",placeholder:"مثال: 123456",class:"input-large",onKeyup:L(P,["enter"])},null,544),[[K,l(_)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!l(_)||l(c),onClick:P},[l(c)?(d(),i("span",is,[...t[10]||(t[10]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),u(" جاري البحث...",-1)])])):(d(),i("span",os,"بحث"))],8,ns)])])):b("",!0),l(o)===2?(d(),i("div",ds,[s("div",rs,[t[17]||(t[17]=s("div",{class:"form-icon success"},[s("i",{class:"fas fa-check"})],-1)),t[18]||(t[18]=s("h2",null,"تم العثور على الحوالة!",-1)),t[19]||(t[19]=s("p",null,"أدخل رقم هاتفك للتحقق من هويتك",-1)),s("div",us,[(d(!0),i(C,null,j(l(x),(p,k)=>(d(),i("div",{key:k,class:"phone-item"},[t[14]||(t[14]=s("i",{class:"fas fa-phone"},null,-1)),s("span",null,[u(n(p.label)+": ",1),s("span",ps,n(p.masked),1)])]))),128))]),s("div",vs,[I(s("input",{"onUpdate:modelValue":t[1]||(t[1]=p=>S(m)?m.value=p:null),type:"tel",placeholder:"أدخل رقم هاتفك الكامل",class:"input-large",dir:"ltr",onKeyup:L(F,["enter"])},null,544),[[K,l(m)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!l(m)||l(c),onClick:F},[l(c)?(d(),i("span",bs,[...t[15]||(t[15]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),u(" جاري الإرسال...",-1)])])):(d(),i("span",fs,"إرسال رمز التحقق"))],8,cs),s("button",{class:"btn btn-outline btn-sm",onClick:U},[...t[16]||(t[16]=[s("i",{class:"fas fa-arrow-right"},null,-1),u(" رجوع ",-1)])])])])):b("",!0),l(o)===3?(d(),i("div",_s,[s("div",ms,[t[22]||(t[22]=s("div",{class:"form-icon"},[s("i",{class:"fab fa-whatsapp"})],-1)),t[23]||(t[23]=s("h2",null,"أدخل رمز التحقق",-1)),t[24]||(t[24]=s("p",null,"تم إرسال رمز مكون من 4 أرقام إلى واتساب",-1)),s("div",{class:v(["role-badge",l(h)])},[s("i",{class:v(l(h)==="sender"?"fas fa-paper-plane":"fas fa-inbox")},null,2),s("span",null,n(l(V)),1)],2),s("div",ys,[(d(),i(C,null,j(4,p=>I(s("input",{key:p,ref_for:!0,ref:k=>l(D)[p-1]=k,"onUpdate:modelValue":k=>l(y)[p-1]=k,type:"text",maxlength:"1",class:"otp-input",onInput:k=>z(p-1),onKeydown:L(k=>G(p-1),["backspace"])},null,40,ks),[[K,l(y)[p-1]]])),64))]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:l(y).join("").length!==4||l(c),onClick:E},[l(c)?(d(),i("span",hs,[...t[20]||(t[20]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),u(" جاري التحقق...",-1)])])):(d(),i("span",ws,"تحقق"))],8,gs),s("button",{class:"btn btn-outline btn-sm",onClick:U},[...t[21]||(t[21]=[s("i",{class:"fas fa-arrow-right"},null,-1),u(" رجوع ",-1)])])])])):b("",!0),l(o)===4?(d(),i("div",Cs,[s("div",Ts,[s("div",$s,[s("div",{class:v(["result-icon",l(a)?.status_class])},[...t[25]||(t[25]=[s("i",{class:"fas fa-receipt"},null,-1)])],2),t[26]||(t[26]=s("h2",null,"تفاصيل الحوالة",-1)),s("div",{class:v(["transfer-type-badge",l(g)])},[s("i",{class:v(l(g)==="internal"?"fas fa-home":"fas fa-globe")},null,2),s("span",null,n(l(N)),1)],2)]),s("div",xs,[l(g)==="internal"?(d(),i(C,{key:0},[s("div",Bs,[t[27]||(t[27]=s("span",{class:"label"},"الفرع المرسل",-1)),s("span",Vs,n(l(a)?.branch_received),1)]),s("div",Ds,[t[28]||(t[28]=s("span",{class:"label"},"رقم الحوالة",-1)),s("span",Ns,n(l(a)?.code),1)]),s("div",Os,[t[29]||(t[29]=s("span",{class:"label"},"المرسل",-1)),s("span",qs,n(l(a)?.sender_name),1)]),s("div",Is,[t[32]||(t[32]=s("span",{class:"label"},"تاريخ الارسال",-1)),s("div",Ks,[s("span",Ls,[t[30]||(t[30]=s("i",{class:"far fa-calendar-alt"},null,-1)),u(" "+n(O(l(a)?.insert_date)),1)]),s("span",Ps,[t[31]||(t[31]=s("i",{class:"far fa-clock"},null,-1)),u(" "+n(q(l(a)?.insert_date)),1)])])]),s("div",Fs,[t[33]||(t[33]=s("span",{class:"label"},"تسليم في",-1)),s("span",Us,n(l(a)?.branch_delivered),1)]),s("div",Ms,[t[34]||(t[34]=s("span",{class:"label"},"المستلم",-1)),s("span",Rs,n(l(a)?.receiver_name),1)]),s("div",Ss,[t[35]||(t[35]=s("span",{class:"label"},"المبلغ",-1)),s("span",js,n(l(a)?.amount)+" د.ل",1)]),s("div",Es,[t[36]||(t[36]=s("span",{class:"label"},"حالة الحوالة",-1)),s("div",{class:v(["status-badge",l(a)?.status_class])},n(l(a)?.status),3)]),(Number(l(a)?.status_code)===2||Number(l(a)?.status_code)===3)&&l(a)?.received_date?(d(),i("div",zs,[t[39]||(t[39]=s("span",{class:"label"},"تاريخ التسليم",-1)),s("div",Gs,[s("span",Ys,[t[37]||(t[37]=s("i",{class:"far fa-calendar-alt"},null,-1)),u(" "+n(O(l(a)?.received_date)),1)]),s("span",As,[t[38]||(t[38]=s("i",{class:"far fa-clock"},null,-1)),u(" "+n(q(l(a)?.received_date)),1)])])])):b("",!0)],64)):(d(),i(C,{key:1},[s("div",Hs,[t[40]||(t[40]=s("span",{class:"label"},"رقم الحوالة",-1)),s("span",Js,n(l(a)?.code),1)]),s("div",Qs,[t[41]||(t[41]=s("span",{class:"label"},"حالة الحوالة",-1)),s("div",{class:v(["status-badge",l(a)?.status_class])},n(l(a)?.status),3)]),s("div",Ws,[t[42]||(t[42]=s("span",{class:"label"},"المرسل",-1)),s("span",Xs,n(l(a)?.sender_name),1)]),s("div",Zs,[t[43]||(t[43]=s("span",{class:"label"},"المستلم",-1)),s("span",st,n(l(a)?.receiver_name),1)]),s("div",tt,[t[44]||(t[44]=s("span",{class:"label"},"المبلغ بالدينار الليبي",-1)),s("span",lt,n(l(a)?.amount_lyd)+" LYD",1)]),s("div",at,[t[45]||(t[45]=s("span",{class:"label"},"المبلغ الإجمالي",-1)),s("span",et,n(l(a)?.amount_total),1)]),s("div",nt,[t[48]||(t[48]=s("span",{class:"label"},"تاريخ الإرسال",-1)),s("div",ot,[s("span",it,[t[46]||(t[46]=s("i",{class:"far fa-calendar-alt"},null,-1)),u(" "+n(O(l(a)?.insert_date)),1)]),s("span",dt,[t[47]||(t[47]=s("i",{class:"far fa-clock"},null,-1)),u(" "+n(q(l(a)?.insert_date)),1)])])]),l(a)?.service_type?(d(),i("div",rt,[t[49]||(t[49]=s("span",{class:"label"},"نوع الخدمة",-1)),s("span",ut,n(l(a)?.service_type),1)])):b("",!0),l(a)?.country?(d(),i("div",pt,[t[50]||(t[50]=s("span",{class:"label"},"الدولة",-1)),s("span",vt,n(l(a)?.country),1)])):b("",!0)],64))]),s("div",ct,[s("button",{class:"btn btn-primary btn-lg",onClick:Y},[...t[51]||(t[51]=[s("i",{class:"fas fa-search"},null,-1),u(" استعلام جديد ",-1)])]),M(w,{to:"/",class:"btn btn-outline btn-lg"},{default:R(()=>[...t[52]||(t[52]=[s("i",{class:"fas fa-home"},null,-1),u(" الرئيسية ",-1)])]),_:1})])])])):b("",!0),l(f)?(d(),i("div",ft,[t[54]||(t[54]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),s("span",null,n(l(f)),1),s("button",{onClick:t[2]||(t[2]=p=>f.value="")},[...t[53]||(t[53]=[s("i",{class:"fas fa-times"},null,-1)])])])):b("",!0)])])}}}),yt=W(bt,[["__scopeId","data-v-e5cb70d8"]]);export{yt as default};
