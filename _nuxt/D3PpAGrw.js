import{g as I,y as L,H as O,x as R,l as d,B as z,k as x,c as i,a as s,q as _,d as u,b as C,w as F,j as l,m as W,s as m,v as g,G as A,n as y,F as D,t as P,i as G,o as r,_ as H}from"./a-Cwvg04.js";import{_ as J}from"./BcDViexZ.js";import{u as K}from"./GFgnp2px.js";const Q={class:"booking-page"},X={class:"container"},Y={class:"page-header"},Z={class:"bank-logo-wrapper"},ss={class:"bank-logo-container"},ts=["src"],ls={key:0,class:"disabled-message"},ns={key:1,class:"form-card"},os={class:"form-section"},as={class:"form-row"},es={class:"form-group"},is={class:"form-group"},rs={class:"form-row"},ps={class:"form-group"},ds={class:"form-group"},us={class:"form-row"},fs={class:"form-group"},ms={class:"form-group"},cs={class:"form-section"},vs={class:"file-grid"},bs={class:"form-group"},gs={for:"passport_photo",class:"file-label"},_s={key:1,class:"pdf-preview"},ys=["src"],ks={class:"form-group"},ws={for:"national_id_photo",class:"file-label"},hs={key:1,class:"pdf-preview"},qs=["src"],xs={class:"form-group"},Cs={for:"voucher_photo",class:"file-label"},Fs={key:1,class:"pdf-preview"},Ds=["src"],Bs={class:"submit-wrapper"},Ss=["disabled"],Vs={key:0,class:"modal-overlay show"},Ps={class:"modal"},Ms={class:"modal-body success-body"},$s={class:"tracking-code-display"},Ns={class:"success-actions"},Us=I({__name:"index",setup(Es){L({title:"حجز بطاقة أغراض شخصية | شركة الرحالة",description:"خدمة حجز بطاقات الأغراض الشخصية للمواطنين عبر شركة الرحالة للصرافة"});const{isDark:M}=O(),{success:$,error:c}=K(),B=R().public.apiBase,k=d(!0),N=d(!0);z(async()=>{try{const n=await $fetch(`${B}/booking-cards/status`);k.value=n.enabled}catch{k.value=!0}finally{N.value=!1}});const o=x({name:"",phone:"",national_id:"",payment_type:"",account_number:"",booking_amount:""}),p=x({passport:null,voucher:null,national_id:null}),e=x({passport:"",voucher:"",national_id:""}),v=d(!1);d(""),d(!1);const U=d(["","","",""]);d([]),d(""),d(!1);const S=d(!1),V=d(""),w=(n,t)=>{const f=n.target.files?.[0];if(f&&(f.type.startsWith("image/")||f.type==="application/pdf")){if(f.size>10*1024*1024){c("حجم الملف يجب أن يكون أقل من 10MB");return}if(p[t]=f,f.type.startsWith("image/")){const a=new FileReader;a.onload=j=>{e[t]=j.target?.result},a.readAsDataURL(f)}else e[t]="pdf"}},h=n=>p[n]?.type==="application/pdf",q=n=>{p[n]=null,e[n]="";const t=document.getElementById(`${n}_photo`);t&&(t.value="")},E=async()=>{if(!p.passport||!p.voucher||!p.national_id){c("يرجى رفع المستندات الأساسية المطلوبة");return}if(Number(o.booking_amount)>2e3){c("قيمة الحجز لا يمكن أن تتجاوز 2000 دولار");return}v.value=!0;try{const n=new FormData;n.append("name",o.name),n.append("phone",o.phone),n.append("national_id",o.national_id),n.append("payment_type",o.payment_type.toString()),n.append("account_number",o.account_number),n.append("booking_amount",o.booking_amount),p.passport&&n.append("passport_photo",p.passport),p.voucher&&n.append("voucher_photo",p.voucher),p.national_id&&n.append("national_id_photo",p.national_id);const t=await $fetch(`${B}/booking-cards/store`,{method:"POST",body:n});t.success&&(V.value=t.tracking_code,S.value=!0,$("تم تقديم طلب حجز البطاقة بنجاح"),T())}catch(n){if(console.error("Step 1 failed:",n.data||n),n.data?.errors){const t=Object.values(n.data.errors).flat().join(`
`);c(t)}else c(n.data?.message||"حدث خطأ أثناء إرسال البيانات")}finally{v.value=!1}},T=()=>{o.name="",o.phone="",o.national_id="",o.payment_type="",o.account_number="",o.booking_amount="",p.passport=null,p.voucher=null,p.national_id=null,e.passport="",e.voucher="",e.national_id="",U.value=["","","",""],["passport_photo","voucher_photo","national_id_photo"].forEach(t=>{const b=document.getElementById(t);b&&(b.value="")})};return(n,t)=>{const b=G,f=J;return r(),i("div",Q,[s("div",X,[s("div",Y,[t[13]||(t[13]=s("div",{class:"header-badge"},[s("i",{class:"fas fa-id-card"}),s("span",null,"شركة الرحالة للصرافة والخدمات المالية")],-1)),t[14]||(t[14]=s("h1",{class:"page-title"},[u("منصة الرحالة "),s("span",{class:"gradient-text"},"للصرافة مخصصه لزبائن المصرف التجاري الوطني")],-1)),s("div",Z,[C(b,null,{default:F(()=>[s("div",ss,[s("img",{src:l(M)?"/images/ncb-dark.png":"/images/ncb-light.png",alt:"National Commercial Bank",class:"bank-logo"},null,8,ts),t[12]||(t[12]=s("div",{class:"logo-shimmer"},null,-1))])]),_:1})])]),l(k)?(r(),i("div",ns,[s("form",{onSubmit:W(E,["prevent"])},[t[41]||(t[41]=s("div",{class:"status-alert warning"},[s("i",{class:"fas fa-university"}),s("span",null,[u("يشترط سداد قيمة الحجز بالدينار الليبي بتحويل مصرفي صادر من حساب صاحب البطاقة حصراً إلى حساب شركة الرحالة للصرافة رقم: "),s("strong",null,"122012276814011")])],-1)),s("div",os,[t[23]||(t[23]=s("h3",{class:"section-title"},[s("i",{class:"fas fa-user-edit"}),s("span",null,"المعلومات الشخصية")],-1)),s("div",as,[s("div",es,[t[16]||(t[16]=s("label",{class:"label"},[u("الإسم بالكامل "),s("span",{class:"required"},"*")],-1)),m(s("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>l(o).name=a),type:"text",class:"input",placeholder:"أدخل اسمك كما هو في الجواز",required:""},null,512),[[g,l(o).name]])]),s("div",is,[t[17]||(t[17]=s("label",{class:"label"},[u("الرقم الوطني (12 رقم) "),s("span",{class:"required"},"*")],-1)),m(s("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>l(o).national_id=a),type:"text",class:"input",maxlength:"12",inputmode:"numeric",pattern:"[0-9]{12}",placeholder:"مثال: 119900123456",required:""},null,512),[[g,l(o).national_id]])])]),s("div",rs,[s("div",ps,[t[18]||(t[18]=s("label",{class:"label"},[u("رقم الهاتف "),s("span",{class:"required"},"*")],-1)),m(s("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>l(o).phone=a),type:"tel",class:"input",placeholder:"مثال: 0912345678",required:""},null,512),[[g,l(o).phone]])]),s("div",ds,[t[20]||(t[20]=s("label",{class:"label"},[u("نوع الدفع "),s("span",{class:"required"},"*")],-1)),m(s("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>l(o).payment_type=a),class:"input select-input",required:""},[...t[19]||(t[19]=[s("option",{value:"",disabled:"",selected:""},"اختر نوع الدفع",-1),s("option",{value:0},"نقدي",-1),s("option",{value:1},"مصرف",-1)])],512),[[A,l(o).payment_type]])])]),s("div",us,[s("div",fs,[t[21]||(t[21]=s("label",{class:"label"},[u("رقم الحساب "),s("span",{class:"required"},"*")],-1)),m(s("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>l(o).account_number=a),type:"text",class:"input",inputmode:"numeric",placeholder:"أدخل رقم الحساب الجاري",required:""},null,512),[[g,l(o).account_number]])]),s("div",ms,[t[22]||(t[22]=s("label",{class:"label"},[u("قيمة الحجز بالدولار "),s("span",{class:"required"},"*")],-1)),m(s("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>l(o).booking_amount=a),type:"number",step:"0.01",class:"input",placeholder:"مثال: 100",required:""},null,512),[[g,l(o).booking_amount]])])])]),t[42]||(t[42]=s("hr",{class:"divider"},null,-1)),s("div",cs,[t[39]||(t[39]=s("h3",{class:"section-title"},[s("i",{class:"fas fa-file-invoice"}),s("span",null,"المستندات المطلوبة")],-1)),t[40]||(t[40]=s("div",{class:"status-alert warning",style:{"margin-bottom":"25px"}},[s("i",{class:"fas fa-info-circle"}),s("span",null,"يرجى ملء البيانات بدقة ورفع المستندات المطلوبة (صور أو PDF بحد أقصى 10 ميجا)")],-1)),s("div",vs,[s("div",bs,[t[28]||(t[28]=s("label",{class:"label"},[u("صورة جواز السفر "),s("span",{class:"required"},"*")],-1)),s("div",{class:y(["file-wrapper",{"has-file":l(e).passport}])},[s("input",{type:"file",id:"passport_photo",class:"file-input",onChange:t[6]||(t[6]=a=>w(a,"passport")),accept:"image/*,.pdf",required:""},null,32),s("label",gs,[l(e).passport?h("passport")?(r(),i("div",_s,[...t[26]||(t[26]=[s("i",{class:"fas fa-file-pdf"},null,-1),s("span",null,"PDF جاهز",-1)])])):(r(),i("img",{key:2,src:l(e).passport,class:"preview-img"},null,8,ys)):(r(),i(D,{key:0},[t[24]||(t[24]=s("i",{class:"fas fa-file-upload"},null,-1)),t[25]||(t[25]=s("span",null,"رفع الجواز (صورة أو PDF)",-1))],64))]),l(e).passport?(r(),i("button",{key:0,type:"button",class:"remove-btn",onClick:t[7]||(t[7]=a=>q("passport"))},[...t[27]||(t[27]=[s("i",{class:"fas fa-times"},null,-1)])])):_("",!0)],2)]),s("div",ks,[t[33]||(t[33]=s("label",{class:"label"},[u("صورة شهادة الرقم الوطني "),s("span",{class:"required"},"*")],-1)),s("div",{class:y(["file-wrapper",{"has-file":l(e).national_id}])},[s("input",{type:"file",id:"national_id_photo",class:"file-input",onChange:t[8]||(t[8]=a=>w(a,"national_id")),accept:"image/*,.pdf",required:""},null,32),s("label",ws,[l(e).national_id?h("national_id")?(r(),i("div",hs,[...t[31]||(t[31]=[s("i",{class:"fas fa-file-pdf"},null,-1),s("span",null,"PDF جاهز",-1)])])):(r(),i("img",{key:2,src:l(e).national_id,class:"preview-img"},null,8,qs)):(r(),i(D,{key:0},[t[29]||(t[29]=s("i",{class:"fas fa-address-card"},null,-1)),t[30]||(t[30]=s("span",null,"رفع شهادة الرقم الوطني (صورة أو PDF)",-1))],64))]),l(e).national_id?(r(),i("button",{key:0,type:"button",class:"remove-btn",onClick:t[9]||(t[9]=a=>q("national_id"))},[...t[32]||(t[32]=[s("i",{class:"fas fa-times"},null,-1)])])):_("",!0)],2)]),s("div",xs,[t[38]||(t[38]=s("label",{class:"label"},[u("صورة قسيمة التحويل "),s("span",{class:"required"},"*")],-1)),s("div",{class:y(["file-wrapper",{"has-file":l(e).voucher}])},[s("input",{type:"file",id:"voucher_photo",class:"file-input",onChange:t[10]||(t[10]=a=>w(a,"voucher")),accept:"image/*,.pdf",required:""},null,32),s("label",Cs,[l(e).voucher?h("voucher")?(r(),i("div",Fs,[...t[36]||(t[36]=[s("i",{class:"fas fa-file-pdf"},null,-1),s("span",null,"PDF جاهز",-1)])])):(r(),i("img",{key:2,src:l(e).voucher,class:"preview-img"},null,8,Ds)):(r(),i(D,{key:0},[t[34]||(t[34]=s("i",{class:"fas fa-receipt"},null,-1)),t[35]||(t[35]=s("span",null,"رفع قسيمة التحويل (صورة أو PDF)",-1))],64))]),l(e).voucher?(r(),i("button",{key:0,type:"button",class:"remove-btn",onClick:t[11]||(t[11]=a=>q("voucher"))},[...t[37]||(t[37]=[s("i",{class:"fas fa-times"},null,-1)])])):_("",!0)],2)])])]),t[43]||(t[43]=s("div",{class:"status-alert warning bottom-alert"},[s("i",{class:"fas fa-exclamation-triangle"}),s("span",null,"يرجى التأكد من ان التحويل المالي تم من نفس حساب صاحب البطاقه إلى حساب الشركة المذكور أعلاه")],-1)),s("div",Bs,[s("button",{type:"submit",class:"submit-btn",disabled:l(v)},[s("span",null,P(l(v)?"جاري المعالجة...":"ارسال المرفقات"),1),s("i",{class:y(l(v)?"fas fa-spinner fa-spin":"fas fa-paper-plane")},null,2)],8,Ss)])],32)])):(r(),i("div",ls,[...t[15]||(t[15]=[s("div",{class:"disabled-card"},[s("i",{class:"fas fa-ban disabled-icon"}),s("h2",null,"المنصة غير متاحة حاليًا."),s("p",null,"منصة الرحالة مرتبطة تقنيًا بمنصة مصرف ليبيا المركزي، وتعمل فقط خلال فترات الحجز الرسمية")],-1)])]))]),l(S)?(r(),i("div",Vs,[s("div",Ps,[s("div",Ms,[t[46]||(t[46]=s("div",{class:"success-icon"},[s("i",{class:"fas fa-check-circle"})],-1)),t[47]||(t[47]=s("h2",null,"تم تقديم طلبك بنجاح!",-1)),t[48]||(t[48]=s("p",null,"رقم تتبع الحجز الخاص بك:",-1)),s("div",$s,P(l(V)),1),t[49]||(t[49]=s("p",{class:"hint"},"احتفظ بهذا الرقم لتتبع حالة حجزك لاحقاً",-1)),s("div",Ns,[C(f,{to:"/",class:"submit-btn secondary"},{default:F(()=>[...t[44]||(t[44]=[s("i",{class:"fas fa-home"},null,-1),s("span",null,"الرئيسية",-1)])]),_:1}),C(f,{to:"/booking-cards/track",class:"submit-btn"},{default:F(()=>[...t[45]||(t[45]=[s("i",{class:"fas fa-search"},null,-1),s("span",null,"تتبع الطلب",-1)])]),_:1})])])])])):_("",!0)])}}}),Os=H(Us,[["__scopeId","data-v-aecf7775"]]);export{Os as default};
