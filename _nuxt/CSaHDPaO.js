import{h as E,E as K,y as D,i as u,c as n,a as t,f as N,l as w,m as a,B as g,C,G as U,t as i,n as k,F as x,r as $,D as B,o,K as j,_ as F}from"./D7GL1qny.js";const M={class:"wu-page"},P={class:"container"},R={class:"wu-form-card"},z={key:0,class:"wu-step"},G={class:"wu-form-group"},L={key:0,class:"wu-error",style:{display:"block"}},q=["disabled"],A={key:1,class:"wu-step"},H={class:"wu-otp-wrapper"},J=["onUpdate:modelValue","onInput","onKeydown"],Q={key:0,class:"wu-error",style:{display:"block","text-align":"center"}},W={class:"wu-btn-group"},X=["disabled"],Y={key:2,class:"wu-step"},Z={key:0,class:"table-wrapper"},tt={class:"wu-results-table"},st={key:1,class:"wu-no-results"},et=E({__name:"track",setup(at){K({title:"تتبع طلب ويسترن يونيون | الرحالة للصرافة",description:"تتبع حالة طلب تحويل ويسترن يونيون الخاص بك"}),D();const r=u(1),c=u(""),p=u(""),b=u(!1),_=u(""),d=u(["","","",""]),m=u([]),v=u(""),f=u(!1),h=u([]),S=async()=>{if(!c.value){p.value="يرجى إدخال رقم الهاتف";return}b.value=!0,p.value="";try{const l=B(),s=await $fetch(`${l.public.apiBase}/western-union/track`,{method:"POST",body:{phone:c.value}});s.success&&(_.value=s.token,r.value=2)}catch(l){p.value=l.data?.message||"حدث خطأ. يرجى المحاولة مرة أخرى."}finally{b.value=!1}},V=l=>{d.value[l]&&l<3&&m.value[l+1]?.focus()},I=(l,s)=>{!d.value[l]&&l>0&&m.value[l-1]?.focus()},O=async()=>{const l=d.value.join("");if(l.length!==4){v.value="يرجى إدخال الرمز كاملاً";return}f.value=!0,v.value="";try{const s=B(),e=await $fetch(`${s.public.apiBase}/western-union/verify-tracking-otp`,{method:"POST",body:{token:_.value,otp:l}});e.success&&(h.value=e.transfers,r.value=3)}catch(s){v.value=s.data?.message||"رمز التحقق غير صحيح"}finally{f.value=!1}},T=()=>{r.value=1,c.value="",d.value=["","","",""],h.value=[],_.value=""};return(l,s)=>(o(),n("div",M,[t("div",P,[s[10]||(s[10]=N('<div class="wu-header" data-v-6bb9b5f4><div class="wu-badge" data-v-6bb9b5f4><i class="fas fa-search-location" data-v-6bb9b5f4></i><span data-v-6bb9b5f4>ويسترن يونيون</span></div><h1 class="wu-title" data-v-6bb9b5f4>تتبع <span class="gradient-text" data-v-6bb9b5f4>طلب التحويل</span></h1><p class="wu-subtitle" data-v-6bb9b5f4>أدخل رقم هاتفك للبحث عن طلباتك</p></div>',1)),t("div",R,[a(r)===1?(o(),n("div",z,[t("div",G,[s[2]||(s[2]=t("label",{class:"wu-label"},"رقم الهاتف",-1)),g(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>U(c)?c.value=e:null),type:"tel",class:"wu-input",placeholder:"أدخل رقم هاتفك"},null,512),[[C,a(c)]]),s[3]||(s[3]=t("p",{class:"wu-hint"},"نفس الرقم المستخدم في طلب التحويل",-1)),a(p)?(o(),n("div",L,i(a(p)),1)):w("",!0)]),t("button",{type:"button",class:"wu-btn wu-btn-primary",onClick:S,disabled:a(b)},[t("i",{class:k(a(b)?"fas fa-spinner fa-spin":"fas fa-search")},null,2),t("span",null,i(a(b)?"جاري البحث...":"بحث"),1)],8,q)])):w("",!0),a(r)===2?(o(),n("div",A,[s[5]||(s[5]=t("p",null,"تم إرسال رمز التحقق إلى رقم هاتفك عبر الواتساب",-1)),t("div",H,[(o(),n(x,null,$(4,e=>g(t("input",{key:e,ref_for:!0,ref:y=>a(m)[e-1]=y,"onUpdate:modelValue":y=>a(d)[e-1]=y,type:"text",class:"wu-otp-input",maxlength:"1",onInput:y=>V(e-1),onKeydown:j(y=>I(e-1),["backspace"])},null,40,J),[[C,a(d)[e-1]]])),64))]),a(v)?(o(),n("div",Q,i(a(v)),1)):w("",!0),t("div",W,[t("button",{type:"button",class:"wu-btn wu-btn-primary",onClick:O,disabled:a(f)},[t("i",{class:k(a(f)?"fas fa-spinner fa-spin":"fas fa-check")},null,2),t("span",null,i(a(f)?"جاري التحقق...":"تأكيد"),1)],8,X),t("button",{type:"button",class:"wu-btn wu-btn-outline",onClick:s[1]||(s[1]=e=>r.value=1)},[...s[4]||(s[4]=[t("span",null,"رجوع",-1)])])])])):w("",!0),a(r)===3?(o(),n("div",Y,[s[9]||(s[9]=t("h3",{style:{"margin-bottom":"20px",display:"flex","align-items":"center","justify-content":"center",gap:"10px"}},[t("i",{class:"fas fa-list"}),t("span",null,"طلباتك")],-1)),a(h).length>0?(o(),n("div",Z,[t("table",tt,[s[6]||(s[6]=t("thead",null,[t("tr",null,[t("th",null,"رقم التتبع"),t("th",null,"اسم المستلم"),t("th",null,"المبلغ"),t("th",null,"الحالة"),t("th",null,"التاريخ")])],-1)),t("tbody",null,[(o(!0),n(x,null,$(a(h),e=>(o(),n("tr",{key:e.tracking_code},[t("td",null,i(e.tracking_code),1),t("td",null,i(e.receiver_name),1),t("td",null,"$"+i(e.amount),1),t("td",null,[t("span",{class:k(["wu-status-badge",e.status_class])},i(e.status_label),3)]),t("td",null,i(e.created_at),1)]))),128))])])])):(o(),n("div",st,[...s[7]||(s[7]=[t("i",{class:"fas fa-inbox"},null,-1),t("p",null,"لا توجد طلبات",-1)])])),t("div",{class:"wu-btn-group",style:{"margin-top":"30px"}},[t("button",{type:"button",class:"wu-btn wu-btn-outline",onClick:T},[...s[8]||(s[8]=[t("i",{class:"fas fa-arrow-right"},null,-1),t("span",null,"بحث جديد",-1)])])])])):w("",!0)])])]))}}),nt=F(et,[["__scopeId","data-v-6bb9b5f4"]]);export{nt as default};
