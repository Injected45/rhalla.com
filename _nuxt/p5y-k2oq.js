import{h as G,E as Y,i as u,c as i,a as s,l as b,b as P,w as U,d as f,n as p,m as l,B as O,C as q,K as D,G as F,F as h,r as M,t as n,D as A,e as H,o as d,_ as J}from"./BYxyiRdG.js";const Q={class:"transfer-inquiry-page"},W={class:"container"},X={class:"page-header"},Z={class:"progress-steps"},ss={key:0,class:"step-content"},ts={class:"form-card"},ls={class:"form-group"},es=["disabled"],as={key:0},ns={key:1},os={key:1,class:"step-content"},is={class:"form-card"},ds={class:"phones-list"},us={dir:"ltr"},rs={class:"form-group"},ps=["disabled"],vs={key:0},cs={key:1},fs={key:2,class:"step-content"},bs={class:"form-card"},_s={class:"otp-inputs"},ms=["onUpdate:modelValue","onInput","onKeydown"],ys=["disabled"],gs={key:0},ks={key:1},ws={key:3,class:"step-content"},hs={class:"result-card"},Cs={class:"result-header"},xs={class:"result-details"},Ts={class:"detail-row"},Bs={class:"value"},$s={class:"detail-row"},Vs={class:"value code"},Ns={class:"detail-row"},Os={class:"value"},qs={class:"detail-row"},Ds={class:"value"},Is={class:"detail-row"},Ks={class:"value"},Ls={class:"detail-row highlight"},Ss={class:"value amount"},Ps={class:"detail-row"},Us={class:"value"},Fs={class:"detail-row"},Ms={key:0,class:"detail-row"},Rs={class:"value status-date"},js={class:"detail-row"},Es={class:"value code"},zs={class:"detail-row"},Gs={class:"detail-row"},Ys={class:"value"},As={class:"detail-row"},Hs={class:"value"},Js={class:"detail-row highlight"},Qs={class:"value amount"},Ws={class:"detail-row highlight"},Xs={class:"value amount"},Zs={class:"detail-row"},st={class:"value"},tt={key:0,class:"detail-row"},lt={class:"value"},et={key:1,class:"detail-row"},at={class:"value"},nt={class:"result-actions"},ot={key:4,class:"error-toast"},it=G({__name:"transfer-inquiry",setup(dt){Y({title:"استعلام عن حوالة | شركة الرحالة للصرافة",description:"استعلم عن حوالتك المالية وتتبع حالتها بكل سهولة وأمان مع شركة الرحالة للصرافة"});const C=A(),o=u(1),v=u(!1),c=u(""),_=u(""),x=u(""),T=u([]),m=u(""),B=u(""),w=u(""),$=u(""),y=u(["","","",""]),V=u([]),e=u(null),k=u(""),N=u(""),I=async()=>{if(_.value){v.value=!0,c.value="";try{const a=await $fetch(`${C.public.apiBase}/transfer-inquiry/search`,{method:"POST",body:{code:_.value}});a.success&&(x.value=a.token,T.value=a.phones,o.value=2)}catch(a){c.value=a.data?.message||"لم يتم العثور على حوالة بهذا الرقم"}finally{v.value=!1}}},K=async()=>{if(m.value){v.value=!0,c.value="";try{const a=await $fetch(`${C.public.apiBase}/transfer-inquiry/send-otp`,{method:"POST",body:{token:x.value,phone:m.value}});a.success&&(B.value=a.token,w.value=a.role,$.value=a.role_label,o.value=3)}catch(a){c.value=a.data?.message||"رقم الهاتف غير مطابق"}finally{v.value=!1}}},R=async()=>{const a=y.value.join("");if(a.length===4){v.value=!0,c.value="";try{const t=await $fetch(`${C.public.apiBase}/transfer-inquiry/verify`,{method:"POST",body:{token:B.value,otp:a}});t.success&&(e.value=t.transfer,k.value=t.transfer_type||"internal",N.value=t.transfer_type_label||"حوالة داخلية",o.value=4)}catch(t){c.value=t.data?.message||"رمز التحقق غير صحيح"}finally{v.value=!1}}},j=a=>{y.value[a]&&a<3&&V.value[a+1]?.focus()},E=(a,t)=>{!y.value[a]&&a>0&&V.value[a-1]?.focus()},L=()=>{o.value>1&&(o.value--,c.value="")},z=()=>{o.value=1,_.value="",x.value="",T.value=[],m.value="",B.value="",w.value="",$.value="",y.value=["","","",""],e.value=null,k.value="",N.value="",c.value=""};return(a,t)=>{const S=H;return d(),i("div",Q,[s("div",W,[s("div",X,[P(S,{to:"/",class:"back-link"},{default:U(()=>[...t[3]||(t[3]=[s("i",{class:"fas fa-arrow-right"},null,-1),s("span",null,"العودة للرئيسية",-1)])]),_:1}),t[4]||(t[4]=s("h1",{class:"page-title"},[s("i",{class:"fas fa-search-dollar"}),f(" استعلام عن "),s("span",{class:"gradient-text"},"حوالة")],-1)),t[5]||(t[5]=s("p",{class:"page-subtitle"},"تحقق من حالة حوالتك بكل سهولة وأمان",-1))]),s("div",Z,[s("div",{class:p(["step",{active:l(o)>=1,completed:l(o)>1}])},[...t[6]||(t[6]=[s("div",{class:"step-number"},"1",-1),s("span",null,"رقم الحوالة",-1)])],2),s("div",{class:p(["step-line",{active:l(o)>1}])},null,2),s("div",{class:p(["step",{active:l(o)>=2,completed:l(o)>2}])},[...t[7]||(t[7]=[s("div",{class:"step-number"},"2",-1),s("span",null,"رقم الهاتف",-1)])],2),s("div",{class:p(["step-line",{active:l(o)>2}])},null,2),s("div",{class:p(["step",{active:l(o)>=3,completed:l(o)>3}])},[...t[8]||(t[8]=[s("div",{class:"step-number"},"3",-1),s("span",null,"التحقق",-1)])],2),s("div",{class:p(["step-line",{active:l(o)>3}])},null,2),s("div",{class:p(["step",{active:l(o)>=4}])},[...t[9]||(t[9]=[s("div",{class:"step-number"},"4",-1),s("span",null,"النتيجة",-1)])],2)]),l(o)===1?(d(),i("div",ss,[s("div",ts,[t[11]||(t[11]=s("div",{class:"form-icon"},[s("i",{class:"fas fa-hashtag"})],-1)),t[12]||(t[12]=s("h2",null,"أدخل رقم الحوالة",-1)),t[13]||(t[13]=s("p",null,"أدخل رقم الحوالة المكون من أرقام للاستعلام عنها",-1)),s("div",ls,[O(s("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>F(_)?_.value=r:null),type:"text",placeholder:"مثال: 123456",class:"input-large",onKeyup:D(I,["enter"])},null,544),[[q,l(_)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!l(_)||l(v),onClick:I},[l(v)?(d(),i("span",ns,[...t[10]||(t[10]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),f(" جاري البحث...",-1)])])):(d(),i("span",as,"بحث"))],8,es)])])):b("",!0),l(o)===2?(d(),i("div",os,[s("div",is,[t[17]||(t[17]=s("div",{class:"form-icon success"},[s("i",{class:"fas fa-check"})],-1)),t[18]||(t[18]=s("h2",null,"تم العثور على الحوالة!",-1)),t[19]||(t[19]=s("p",null,"أدخل رقم هاتفك للتحقق من هويتك",-1)),s("div",ds,[(d(!0),i(h,null,M(l(T),(r,g)=>(d(),i("div",{key:g,class:"phone-item"},[t[14]||(t[14]=s("i",{class:"fas fa-phone"},null,-1)),s("span",null,[f(n(r.label)+": ",1),s("span",us,n(r.masked),1)])]))),128))]),s("div",rs,[O(s("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>F(m)?m.value=r:null),type:"tel",placeholder:"أدخل رقم هاتفك الكامل",class:"input-large",dir:"ltr",onKeyup:D(K,["enter"])},null,544),[[q,l(m)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!l(m)||l(v),onClick:K},[l(v)?(d(),i("span",cs,[...t[15]||(t[15]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),f(" جاري الإرسال...",-1)])])):(d(),i("span",vs,"إرسال رمز التحقق"))],8,ps),s("button",{class:"btn btn-outline btn-sm",onClick:L},[...t[16]||(t[16]=[s("i",{class:"fas fa-arrow-right"},null,-1),f(" رجوع ",-1)])])])])):b("",!0),l(o)===3?(d(),i("div",fs,[s("div",bs,[t[22]||(t[22]=s("div",{class:"form-icon"},[s("i",{class:"fab fa-whatsapp"})],-1)),t[23]||(t[23]=s("h2",null,"أدخل رمز التحقق",-1)),t[24]||(t[24]=s("p",null,"تم إرسال رمز مكون من 4 أرقام إلى واتساب",-1)),s("div",{class:p(["role-badge",l(w)])},[s("i",{class:p(l(w)==="sender"?"fas fa-paper-plane":"fas fa-inbox")},null,2),s("span",null,n(l($)),1)],2),s("div",_s,[(d(),i(h,null,M(4,r=>O(s("input",{key:r,ref_for:!0,ref:g=>l(V)[r-1]=g,"onUpdate:modelValue":g=>l(y)[r-1]=g,type:"text",maxlength:"1",class:"otp-input",onInput:g=>j(r-1),onKeydown:D(g=>E(r-1),["backspace"])},null,40,ms),[[q,l(y)[r-1]]])),64))]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:l(y).join("").length!==4||l(v),onClick:R},[l(v)?(d(),i("span",ks,[...t[20]||(t[20]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),f(" جاري التحقق...",-1)])])):(d(),i("span",gs,"تحقق"))],8,ys),s("button",{class:"btn btn-outline btn-sm",onClick:L},[...t[21]||(t[21]=[s("i",{class:"fas fa-arrow-right"},null,-1),f(" رجوع ",-1)])])])])):b("",!0),l(o)===4?(d(),i("div",ws,[s("div",hs,[s("div",Cs,[s("div",{class:p(["result-icon",l(e)?.status_class])},[...t[25]||(t[25]=[s("i",{class:"fas fa-receipt"},null,-1)])],2),t[26]||(t[26]=s("h2",null,"تفاصيل الحوالة",-1)),s("div",{class:p(["transfer-type-badge",l(k)])},[s("i",{class:p(l(k)==="internal"?"fas fa-home":"fas fa-globe")},null,2),s("span",null,n(l(N)),1)],2)]),s("div",xs,[l(k)==="internal"?(d(),i(h,{key:0},[s("div",Ts,[t[27]||(t[27]=s("span",{class:"label"},"مرسلة من",-1)),s("span",Bs,n(l(e)?.branch_received),1)]),s("div",$s,[t[28]||(t[28]=s("span",{class:"label"},"رقم الحوالة",-1)),s("span",Vs,n(l(e)?.code),1)]),s("div",Ns,[t[29]||(t[29]=s("span",{class:"label"},"المرسل",-1)),s("span",Os,n(l(e)?.sender_name),1)]),s("div",qs,[t[30]||(t[30]=s("span",{class:"label"},"تاريخ الارسال",-1)),s("span",Ds,n(l(e)?.insert_date),1)]),s("div",Is,[t[31]||(t[31]=s("span",{class:"label"},"المستلم",-1)),s("span",Ks,n(l(e)?.receiver_name),1)]),s("div",Ls,[t[32]||(t[32]=s("span",{class:"label"},"المبلغ",-1)),s("span",Ss,n(l(e)?.amount)+" د.ل",1)]),s("div",Ps,[t[33]||(t[33]=s("span",{class:"label"},"تسليم في",-1)),s("span",Us,n(l(e)?.branch_delivered),1)]),s("div",Fs,[t[34]||(t[34]=s("span",{class:"label"},"حالة الحوالة",-1)),s("div",{class:p(["status-badge",l(e)?.status_class])},n(l(e)?.status),3)]),(Number(l(e)?.status_code)===2||Number(l(e)?.status_code)===3)&&l(e)?.received_date?(d(),i("div",Ms,[t[35]||(t[35]=s("span",{class:"label"},"تاريخ الإستلام",-1)),s("span",Rs,n(l(e)?.received_date),1)])):b("",!0)],64)):(d(),i(h,{key:1},[s("div",js,[t[36]||(t[36]=s("span",{class:"label"},"رقم الحوالة",-1)),s("span",Es,n(l(e)?.code),1)]),s("div",zs,[t[37]||(t[37]=s("span",{class:"label"},"حالة الحوالة",-1)),s("div",{class:p(["status-badge",l(e)?.status_class])},n(l(e)?.status),3)]),s("div",Gs,[t[38]||(t[38]=s("span",{class:"label"},"المرسل",-1)),s("span",Ys,n(l(e)?.sender_name),1)]),s("div",As,[t[39]||(t[39]=s("span",{class:"label"},"المستلم",-1)),s("span",Hs,n(l(e)?.receiver_name),1)]),s("div",Js,[t[40]||(t[40]=s("span",{class:"label"},"المبلغ بالدينار الليبي",-1)),s("span",Qs,n(l(e)?.amount_lyd)+" LYD",1)]),s("div",Ws,[t[41]||(t[41]=s("span",{class:"label"},"المبلغ الإجمالي",-1)),s("span",Xs,n(l(e)?.amount_total),1)]),s("div",Zs,[t[42]||(t[42]=s("span",{class:"label"},"تاريخ الإرسال",-1)),s("span",st,n(l(e)?.insert_date),1)]),l(e)?.service_type?(d(),i("div",tt,[t[43]||(t[43]=s("span",{class:"label"},"نوع الخدمة",-1)),s("span",lt,n(l(e)?.service_type),1)])):b("",!0),l(e)?.country?(d(),i("div",et,[t[44]||(t[44]=s("span",{class:"label"},"الدولة",-1)),s("span",at,n(l(e)?.country),1)])):b("",!0)],64))]),s("div",nt,[s("button",{class:"btn btn-primary btn-lg",onClick:z},[...t[45]||(t[45]=[s("i",{class:"fas fa-search"},null,-1),f(" استعلام جديد ",-1)])]),P(S,{to:"/",class:"btn btn-outline btn-lg"},{default:U(()=>[...t[46]||(t[46]=[s("i",{class:"fas fa-home"},null,-1),f(" الرئيسية ",-1)])]),_:1})])])])):b("",!0),l(c)?(d(),i("div",ot,[t[48]||(t[48]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),s("span",null,n(l(c)),1),s("button",{onClick:t[2]||(t[2]=r=>c.value="")},[...t[47]||(t[47]=[s("i",{class:"fas fa-times"},null,-1)])])])):b("",!0)])])}}}),rt=J(it,[["__scopeId","data-v-811c3b79"]]);export{rt as default};
