import{h as G,E as Y,i as u,c as n,a as s,l as p,b as N,w as P,d as _,n as v,m as e,B as O,C as q,K as D,G as U,F,r as M,t as r,D as A,e as H,o,_ as J}from"./CvDq7zfc.js";const Q={class:"transfer-inquiry-page"},W={class:"container"},X={class:"page-header"},Z={class:"progress-steps"},ss={key:0,class:"step-content"},ts={class:"form-card"},es={class:"form-group"},ls=["disabled"],as={key:0},ns={key:1},os={key:1,class:"step-content"},is={class:"form-card"},rs={class:"phones-list"},us={dir:"ltr"},ds={class:"form-group"},ps=["disabled"],vs={key:0},cs={key:1},fs={key:2,class:"step-content"},bs={class:"form-card"},_s={class:"otp-inputs"},ms=["onUpdate:modelValue","onInput","onKeydown"],ys=["disabled"],ks={key:0},gs={key:1},hs={key:3,class:"step-content"},ws={class:"result-card"},xs={class:"result-header"},Cs={class:"result-details"},Ts={class:"detail-row"},Bs={class:"value code"},$s={class:"detail-row"},Vs={class:"detail-row"},Os={class:"value"},qs={class:"detail-row"},Ds={class:"value"},Is={key:0,class:"detail-row highlight"},Ks={class:"value amount"},Ls={key:1,class:"detail-row highlight"},Ss={class:"value amount"},Ns={key:2,class:"detail-row highlight"},Ps={class:"value amount"},Us={class:"detail-row"},Fs={class:"value"},Ms={key:3,class:"detail-row"},Rs={class:"value received-date"},js={key:4,class:"detail-row"},Es={class:"value"},zs={key:5,class:"detail-row"},Gs={class:"value"},Ys={key:6,class:"detail-row"},As={class:"value"},Hs={key:7,class:"detail-row"},Js={class:"value"},Qs={class:"result-actions"},Ws={key:4,class:"error-toast"},Xs=G({__name:"transfer-inquiry",setup(Zs){Y({title:"استعلام عن حوالة | شركة الرحالة للصرافة",description:"استعلم عن حوالتك المالية وتتبع حالتها بكل سهولة وأمان مع شركة الرحالة للصرافة"});const w=A(),i=u(1),c=u(!1),b=u(""),m=u(""),x=u(""),C=u([]),y=u(""),T=u(""),h=u(""),B=u(""),k=u(["","","",""]),$=u([]),a=u(null),f=u(""),V=u(""),I=async()=>{if(m.value){c.value=!0,b.value="";try{const l=await $fetch(`${w.public.apiBase}/transfer-inquiry/search`,{method:"POST",body:{code:m.value}});l.success&&(x.value=l.token,C.value=l.phones,i.value=2)}catch(l){b.value=l.data?.message||"لم يتم العثور على حوالة بهذا الرقم"}finally{c.value=!1}}},K=async()=>{if(y.value){c.value=!0,b.value="";try{const l=await $fetch(`${w.public.apiBase}/transfer-inquiry/send-otp`,{method:"POST",body:{token:x.value,phone:y.value}});l.success&&(T.value=l.token,h.value=l.role,B.value=l.role_label,i.value=3)}catch(l){b.value=l.data?.message||"رقم الهاتف غير مطابق"}finally{c.value=!1}}},R=async()=>{const l=k.value.join("");if(l.length===4){c.value=!0,b.value="";try{const t=await $fetch(`${w.public.apiBase}/transfer-inquiry/verify`,{method:"POST",body:{token:T.value,otp:l}});t.success&&(a.value=t.transfer,f.value=t.transfer_type||"internal",V.value=t.transfer_type_label||"حوالة داخلية",i.value=4)}catch(t){b.value=t.data?.message||"رمز التحقق غير صحيح"}finally{c.value=!1}}},j=l=>{k.value[l]&&l<3&&$.value[l+1]?.focus()},E=(l,t)=>{!k.value[l]&&l>0&&$.value[l-1]?.focus()},L=()=>{i.value>1&&(i.value--,b.value="")},z=()=>{i.value=1,m.value="",x.value="",C.value=[],y.value="",T.value="",h.value="",B.value="",k.value=["","","",""],a.value=null,f.value="",V.value="",b.value=""};return(l,t)=>{const S=H;return o(),n("div",Q,[s("div",W,[s("div",X,[N(S,{to:"/",class:"back-link"},{default:P(()=>[...t[3]||(t[3]=[s("i",{class:"fas fa-arrow-right"},null,-1),s("span",null,"العودة للرئيسية",-1)])]),_:1}),t[4]||(t[4]=s("h1",{class:"page-title"},[s("i",{class:"fas fa-search-dollar"}),_(" استعلام عن "),s("span",{class:"gradient-text"},"حوالة")],-1)),t[5]||(t[5]=s("p",{class:"page-subtitle"},"تحقق من حالة حوالتك بكل سهولة وأمان",-1))]),s("div",Z,[s("div",{class:v(["step",{active:e(i)>=1,completed:e(i)>1}])},[...t[6]||(t[6]=[s("div",{class:"step-number"},"1",-1),s("span",null,"رقم الحوالة",-1)])],2),s("div",{class:v(["step-line",{active:e(i)>1}])},null,2),s("div",{class:v(["step",{active:e(i)>=2,completed:e(i)>2}])},[...t[7]||(t[7]=[s("div",{class:"step-number"},"2",-1),s("span",null,"رقم الهاتف",-1)])],2),s("div",{class:v(["step-line",{active:e(i)>2}])},null,2),s("div",{class:v(["step",{active:e(i)>=3,completed:e(i)>3}])},[...t[8]||(t[8]=[s("div",{class:"step-number"},"3",-1),s("span",null,"التحقق",-1)])],2),s("div",{class:v(["step-line",{active:e(i)>3}])},null,2),s("div",{class:v(["step",{active:e(i)>=4}])},[...t[9]||(t[9]=[s("div",{class:"step-number"},"4",-1),s("span",null,"النتيجة",-1)])],2)]),e(i)===1?(o(),n("div",ss,[s("div",ts,[t[11]||(t[11]=s("div",{class:"form-icon"},[s("i",{class:"fas fa-hashtag"})],-1)),t[12]||(t[12]=s("h2",null,"أدخل رقم الحوالة",-1)),t[13]||(t[13]=s("p",null,"أدخل رقم الحوالة المكون من أرقام للاستعلام عنها",-1)),s("div",es,[O(s("input",{"onUpdate:modelValue":t[0]||(t[0]=d=>U(m)?m.value=d:null),type:"text",placeholder:"مثال: 123456",class:"input-large",onKeyup:D(I,["enter"])},null,544),[[q,e(m)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!e(m)||e(c),onClick:I},[e(c)?(o(),n("span",ns,[...t[10]||(t[10]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),_(" جاري البحث...",-1)])])):(o(),n("span",as,"بحث"))],8,ls)])])):p("",!0),e(i)===2?(o(),n("div",os,[s("div",is,[t[17]||(t[17]=s("div",{class:"form-icon success"},[s("i",{class:"fas fa-check"})],-1)),t[18]||(t[18]=s("h2",null,"تم العثور على الحوالة!",-1)),t[19]||(t[19]=s("p",null,"أدخل رقم هاتفك للتحقق من هويتك",-1)),s("div",rs,[(o(!0),n(F,null,M(e(C),(d,g)=>(o(),n("div",{key:g,class:"phone-item"},[t[14]||(t[14]=s("i",{class:"fas fa-phone"},null,-1)),s("span",null,[_(r(d.label)+": ",1),s("span",us,r(d.masked),1)])]))),128))]),s("div",ds,[O(s("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>U(y)?y.value=d:null),type:"tel",placeholder:"أدخل رقم هاتفك الكامل",class:"input-large",dir:"ltr",onKeyup:D(K,["enter"])},null,544),[[q,e(y)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!e(y)||e(c),onClick:K},[e(c)?(o(),n("span",cs,[...t[15]||(t[15]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),_(" جاري الإرسال...",-1)])])):(o(),n("span",vs,"إرسال رمز التحقق"))],8,ps),s("button",{class:"btn btn-outline btn-sm",onClick:L},[...t[16]||(t[16]=[s("i",{class:"fas fa-arrow-right"},null,-1),_(" رجوع ",-1)])])])])):p("",!0),e(i)===3?(o(),n("div",fs,[s("div",bs,[t[22]||(t[22]=s("div",{class:"form-icon"},[s("i",{class:"fab fa-whatsapp"})],-1)),t[23]||(t[23]=s("h2",null,"أدخل رمز التحقق",-1)),t[24]||(t[24]=s("p",null,"تم إرسال رمز مكون من 4 أرقام إلى واتساب",-1)),s("div",{class:v(["role-badge",e(h)])},[s("i",{class:v(e(h)==="sender"?"fas fa-paper-plane":"fas fa-inbox")},null,2),s("span",null,r(e(B)),1)],2),s("div",_s,[(o(),n(F,null,M(4,d=>O(s("input",{key:d,ref_for:!0,ref:g=>e($)[d-1]=g,"onUpdate:modelValue":g=>e(k)[d-1]=g,type:"text",maxlength:"1",class:"otp-input",onInput:g=>j(d-1),onKeydown:D(g=>E(d-1),["backspace"])},null,40,ms),[[q,e(k)[d-1]]])),64))]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:e(k).join("").length!==4||e(c),onClick:R},[e(c)?(o(),n("span",gs,[...t[20]||(t[20]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),_(" جاري التحقق...",-1)])])):(o(),n("span",ks,"تحقق"))],8,ys),s("button",{class:"btn btn-outline btn-sm",onClick:L},[...t[21]||(t[21]=[s("i",{class:"fas fa-arrow-right"},null,-1),_(" رجوع ",-1)])])])])):p("",!0),e(i)===4?(o(),n("div",hs,[s("div",ws,[s("div",xs,[s("div",{class:v(["result-icon",e(a)?.status_class])},[...t[25]||(t[25]=[s("i",{class:"fas fa-receipt"},null,-1)])],2),t[26]||(t[26]=s("h2",null,"تفاصيل الحوالة",-1)),s("div",{class:v(["transfer-type-badge",e(f)])},[s("i",{class:v(e(f)==="internal"?"fas fa-home":"fas fa-globe")},null,2),s("span",null,r(e(V)),1)],2)]),s("div",Cs,[s("div",Ts,[t[27]||(t[27]=s("span",{class:"label"},"رقم الحوالة",-1)),s("span",Bs,r(e(a)?.code),1)]),s("div",$s,[t[28]||(t[28]=s("span",{class:"label"},"حالة الحوالة",-1)),s("div",{class:v(["status-badge",e(a)?.status_class])},r(e(a)?.status),3)]),s("div",Vs,[t[29]||(t[29]=s("span",{class:"label"},"المرسل",-1)),s("span",Os,r(e(a)?.sender_name),1)]),s("div",qs,[t[30]||(t[30]=s("span",{class:"label"},"المستلم",-1)),s("span",Ds,r(e(a)?.receiver_name),1)]),e(f)==="internal"?(o(),n("div",Is,[t[31]||(t[31]=s("span",{class:"label"},"المبلغ",-1)),s("span",Ks,r(e(a)?.amount)+" د.ل",1)])):p("",!0),e(f)==="external"?(o(),n("div",Ls,[t[32]||(t[32]=s("span",{class:"label"},"المبلغ بالدينار الليبي",-1)),s("span",Ss,r(e(a)?.amount_lyd)+" LYD",1)])):p("",!0),e(f)==="external"?(o(),n("div",Ns,[t[33]||(t[33]=s("span",{class:"label"},"المبلغ الإجمالي",-1)),s("span",Ps,r(e(a)?.amount_total),1)])):p("",!0),s("div",Us,[t[34]||(t[34]=s("span",{class:"label"},"تاريخ الإرسال",-1)),s("span",Fs,r(e(a)?.insert_date_formatted||e(a)?.insert_date),1)]),e(f)==="internal"&&e(a)?.received_date_formatted?(o(),n("div",Ms,[t[35]||(t[35]=s("span",{class:"label"},"تاريخ الاستلام",-1)),s("span",Rs,r(e(a)?.received_date_formatted),1)])):p("",!0),e(f)==="internal"&&e(a)?.branch_delivered?(o(),n("div",js,[t[36]||(t[36]=s("span",{class:"label"},"فرع الإرسال",-1)),s("span",Es,r(e(a)?.branch_delivered),1)])):p("",!0),e(f)==="internal"&&e(a)?.branch_received?(o(),n("div",zs,[t[37]||(t[37]=s("span",{class:"label"},"فرع الاستلام",-1)),s("span",Gs,r(e(a)?.branch_received),1)])):p("",!0),e(f)==="external"&&e(a)?.service_type?(o(),n("div",Ys,[t[38]||(t[38]=s("span",{class:"label"},"نوع الخدمة",-1)),s("span",As,r(e(a)?.service_type),1)])):p("",!0),e(f)==="external"&&e(a)?.country?(o(),n("div",Hs,[t[39]||(t[39]=s("span",{class:"label"},"الدولة",-1)),s("span",Js,r(e(a)?.country),1)])):p("",!0)]),s("div",Qs,[s("button",{class:"btn btn-primary btn-lg",onClick:z},[...t[40]||(t[40]=[s("i",{class:"fas fa-search"},null,-1),_(" استعلام جديد ",-1)])]),N(S,{to:"/",class:"btn btn-outline btn-lg"},{default:P(()=>[...t[41]||(t[41]=[s("i",{class:"fas fa-home"},null,-1),_(" الرئيسية ",-1)])]),_:1})])])])):p("",!0),e(b)?(o(),n("div",Ws,[t[43]||(t[43]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),s("span",null,r(e(b)),1),s("button",{onClick:t[2]||(t[2]=d=>b.value="")},[...t[42]||(t[42]=[s("i",{class:"fas fa-times"},null,-1)])])])):p("",!0)])])}}}),tt=J(Xs,[["__scopeId","data-v-817ee860"]]);export{tt as default};
