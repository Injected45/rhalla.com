import{f as T,A as M,s as u,c as n,a as t,e as E,h as b,i as e,x,y as w,B as K,t as i,n as k,F as C,r as S,o,I as N}from"./C694Sa0J.js";import{u as U}from"./Bbe_COFG.js";import{_ as j}from"./DlAUqK2U.js";const D={class:"mg-page"},F={class:"container"},G={class:"mg-form-card"},P={key:0,class:"mg-step"},z={class:"mg-form-group"},A={key:0,class:"mg-error",style:{display:"block"}},L=["disabled"],R={key:1,class:"mg-step"},q={class:"mg-otp-wrapper"},H=["onUpdate:modelValue","onInput","onKeydown"],J={key:0,class:"mg-error",style:{display:"block","text-align":"center"}},Q={class:"mg-btn-group"},W=["disabled"],X={key:2,class:"mg-step"},Y={key:0,class:"table-wrapper"},Z={class:"mg-results-table"},tt={key:1,class:"mg-no-results"},st=T({__name:"track",setup(et){M({title:"تتبع طلب موني جرام | الرحالة للصرافة",description:"تتبع حالة طلب تحويل موني جرام MoneyGram الخاص بك بسهولة"}),U();const r=u(1),c=u(""),p=u(""),m=u(!1),h=u(""),d=u(["","","",""]),_=u([]),v=u(""),f=u(!1),y=u([]),V=async()=>{if(!c.value){p.value="يرجى إدخال رقم الهاتف";return}m.value=!0,p.value="";try{const l=await $fetch("/api/moneygram/track",{method:"POST",body:{phone:c.value}});l.success&&(h.value=l.token,r.value=2)}catch(l){p.value=l.data?.message||"لم يتم العثور على طلبات بهذا الرقم."}finally{m.value=!1}},I=l=>{d.value[l]&&l<3&&_.value[l+1]?.focus()},$=(l,s)=>{!d.value[l]&&l>0&&_.value[l-1]?.focus()},B=async()=>{const l=d.value.join("");if(l.length!==4){v.value="يرجى إدخال الرمز كاملاً";return}f.value=!0,v.value="";try{const s=await $fetch("/api/moneygram/verify-tracking-otp",{method:"POST",body:{token:h.value,otp:l}});s.success&&(y.value=s.transfers,r.value=3)}catch(s){v.value=s.data?.message||"رمز التحقق غير صحيح"}finally{f.value=!1}},O=()=>{r.value=1,c.value="",d.value=["","","",""],y.value=[],h.value=""};return(l,s)=>(o(),n("div",D,[t("div",F,[s[10]||(s[10]=E('<div class="mg-header" data-v-f65b86e4><div class="mg-badge" data-v-f65b86e4><i class="fas fa-search-location" data-v-f65b86e4></i><span data-v-f65b86e4>موني جرام</span></div><h1 class="mg-title" data-v-f65b86e4>تتبع <span class="gradient-text mg-color" data-v-f65b86e4>طلب التحويل</span></h1><p class="mg-subtitle" data-v-f65b86e4>أدخل رقم هاتفك للبحث عن طلبات موني جرام الخاصة بك</p></div>',1)),t("div",G,[e(r)===1?(o(),n("div",P,[t("div",z,[s[2]||(s[2]=t("label",{class:"mg-label"},"رقم الهاتف",-1)),x(t("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>K(c)?c.value=a:null),type:"tel",class:"mg-input",placeholder:"أدخل رقم هاتفك"},null,512),[[w,e(c)]]),s[3]||(s[3]=t("p",{class:"mg-hint"},"نفس الرقم المستخدم في طلب التحويل (ليبيا أو مصر)",-1)),e(p)?(o(),n("div",A,i(e(p)),1)):b("",!0)]),t("button",{type:"button",class:"mg-btn mg-btn-primary",onClick:V,disabled:e(m)},[t("i",{class:k(e(m)?"fas fa-spinner fa-spin":"fas fa-search")},null,2),t("span",null,i(e(m)?"جاري البحث...":"بحث"),1)],8,L)])):b("",!0),e(r)===2?(o(),n("div",R,[s[5]||(s[5]=t("p",null,"تم إرسال رمز التحقق إلى رقم هاتفك عبر الواتساب",-1)),t("div",q,[(o(),n(C,null,S(4,a=>x(t("input",{key:a,ref_for:!0,ref:g=>e(_)[a-1]=g,"onUpdate:modelValue":g=>e(d)[a-1]=g,type:"text",class:"mg-otp-input",maxlength:"1",onInput:g=>I(a-1),onKeydown:N(g=>$(a-1),["backspace"])},null,40,H),[[w,e(d)[a-1]]])),64))]),e(v)?(o(),n("div",J,i(e(v)),1)):b("",!0),t("div",Q,[t("button",{type:"button",class:"mg-btn mg-btn-primary",onClick:B,disabled:e(f)},[t("i",{class:k(e(f)?"fas fa-spinner fa-spin":"fas fa-check")},null,2),t("span",null,i(e(f)?"جاري التحقق...":"تأكيد"),1)],8,W),t("button",{type:"button",class:"mg-btn mg-btn-outline",onClick:s[1]||(s[1]=a=>r.value=1)},[...s[4]||(s[4]=[t("span",null,"رجوع",-1)])])])])):b("",!0),e(r)===3?(o(),n("div",X,[s[9]||(s[9]=t("h3",{style:{"margin-bottom":"20px",display:"flex","align-items":"center","justify-content":"center",gap:"10px"}},[t("i",{class:"fas fa-list"}),t("span",null,"طلباتك (MoneyGram)")],-1)),e(y).length>0?(o(),n("div",Y,[t("table",Z,[s[6]||(s[6]=t("thead",null,[t("tr",null,[t("th",null,"رقم التتبع"),t("th",null,"اسم المستلم"),t("th",null,"المبلغ"),t("th",null,"الحالة"),t("th",null,"التاريخ")])],-1)),t("tbody",null,[(o(!0),n(C,null,S(e(y),a=>(o(),n("tr",{key:a.tracking_code},[t("td",null,i(a.tracking_code),1),t("td",null,i(a.receiver_name),1),t("td",null,"$"+i(a.amount),1),t("td",null,[t("span",{class:k(["mg-status-badge","mg-status-"+a.status_class])},i(a.status),3)]),t("td",null,i(a.date),1)]))),128))])])])):(o(),n("div",tt,[...s[7]||(s[7]=[t("i",{class:"fas fa-inbox"},null,-1),t("p",null,"لا توجد طلبات مرتبطة بهذا الرقم",-1)])])),t("div",{class:"mg-btn-group",style:{"margin-top":"30px"}},[t("button",{type:"button",class:"mg-btn mg-btn-outline",onClick:O},[...s[8]||(s[8]=[t("i",{class:"fas fa-arrow-right"},null,-1),t("span",null,"بحث جديد",-1)])])])])):b("",!0)])])]))}}),ot=j(st,[["__scopeId","data-v-f65b86e4"]]);export{ot as default};
