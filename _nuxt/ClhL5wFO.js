import{h as G,E as Y,i as u,c as a,a as s,l as c,b as N,w as P,d as y,n as p,m as e,B as O,C as q,K as D,G as U,F,r as M,t as r,D as A,e as H,o as n,_ as J}from"./pcI6RVsv.js";const Q={class:"transfer-inquiry-page"},W={class:"container"},X={class:"page-header"},Z={class:"progress-steps"},ss={key:0,class:"step-content"},ts={class:"form-card"},es={class:"form-group"},ls=["disabled"],as={key:0},ns={key:1},os={key:1,class:"step-content"},is={class:"form-card"},rs={class:"phones-list"},us={dir:"ltr"},ds={class:"form-group"},ps=["disabled"],vs={key:0},cs={key:1},fs={key:2,class:"step-content"},bs={class:"form-card"},ys={class:"otp-inputs"},ms=["onUpdate:modelValue","onInput","onKeydown"],_s=["disabled"],ks={key:0},gs={key:1},hs={key:3,class:"step-content"},ws={class:"result-card"},xs={class:"result-header"},Cs={class:"result-details"},Ts={class:"detail-row"},Bs={class:"value code"},$s={class:"detail-row"},Vs={class:"value"},Os={class:"detail-row"},qs={class:"value"},Ds={key:0,class:"detail-row highlight"},Is={class:"value amount"},Ks={key:1,class:"detail-row highlight"},Ls={class:"value amount"},Ss={key:2,class:"detail-row highlight"},Ns={class:"value amount"},Ps={class:"detail-row"},Us={class:"value"},Fs={key:3,class:"detail-row"},Ms={class:"value"},Rs={key:4,class:"detail-row"},js={class:"value"},Es={key:5,class:"detail-row"},zs={class:"value"},Gs={key:6,class:"detail-row"},Ys={class:"value"},As={class:"result-actions"},Hs={key:4,class:"error-toast"},Js=G({__name:"transfer-inquiry",setup(Qs){Y({title:"استعلام عن حوالة | شركة الرحالة للصرافة",description:"استعلم عن حوالتك المالية وتتبع حالتها بكل سهولة وأمان مع شركة الرحالة للصرافة"});const w=A(),i=u(1),v=u(!1),f=u(""),m=u(""),x=u(""),C=u([]),_=u(""),T=u(""),h=u(""),B=u(""),k=u(["","","",""]),$=u([]),o=u(null),b=u(""),V=u(""),I=async()=>{if(m.value){v.value=!0,f.value="";try{const l=await $fetch(`${w.public.apiBase}/transfer-inquiry/search`,{method:"POST",body:{code:m.value}});l.success&&(x.value=l.token,C.value=l.phones,i.value=2)}catch(l){f.value=l.data?.message||"لم يتم العثور على حوالة بهذا الرقم"}finally{v.value=!1}}},K=async()=>{if(_.value){v.value=!0,f.value="";try{const l=await $fetch(`${w.public.apiBase}/transfer-inquiry/send-otp`,{method:"POST",body:{token:x.value,phone:_.value}});l.success&&(T.value=l.token,h.value=l.role,B.value=l.role_label,i.value=3)}catch(l){f.value=l.data?.message||"رقم الهاتف غير مطابق"}finally{v.value=!1}}},R=async()=>{const l=k.value.join("");if(l.length===4){v.value=!0,f.value="";try{const t=await $fetch(`${w.public.apiBase}/transfer-inquiry/verify`,{method:"POST",body:{token:T.value,otp:l}});t.success&&(o.value=t.transfer,b.value=t.transfer_type||"internal",V.value=t.transfer_type_label||"حوالة داخلية",i.value=4)}catch(t){f.value=t.data?.message||"رمز التحقق غير صحيح"}finally{v.value=!1}}},j=l=>{k.value[l]&&l<3&&$.value[l+1]?.focus()},E=(l,t)=>{!k.value[l]&&l>0&&$.value[l-1]?.focus()},L=()=>{i.value>1&&(i.value--,f.value="")},z=()=>{i.value=1,m.value="",x.value="",C.value=[],_.value="",T.value="",h.value="",B.value="",k.value=["","","",""],o.value=null,b.value="",V.value="",f.value=""};return(l,t)=>{const S=H;return n(),a("div",Q,[s("div",W,[s("div",X,[N(S,{to:"/",class:"back-link"},{default:P(()=>[...t[3]||(t[3]=[s("i",{class:"fas fa-arrow-right"},null,-1),s("span",null,"العودة للرئيسية",-1)])]),_:1}),t[4]||(t[4]=s("h1",{class:"page-title"},[s("i",{class:"fas fa-search-dollar"}),y(" استعلام عن "),s("span",{class:"gradient-text"},"حوالة")],-1)),t[5]||(t[5]=s("p",{class:"page-subtitle"},"تحقق من حالة حوالتك بكل سهولة وأمان",-1))]),s("div",Z,[s("div",{class:p(["step",{active:e(i)>=1,completed:e(i)>1}])},[...t[6]||(t[6]=[s("div",{class:"step-number"},"1",-1),s("span",null,"رقم الحوالة",-1)])],2),s("div",{class:p(["step-line",{active:e(i)>1}])},null,2),s("div",{class:p(["step",{active:e(i)>=2,completed:e(i)>2}])},[...t[7]||(t[7]=[s("div",{class:"step-number"},"2",-1),s("span",null,"رقم الهاتف",-1)])],2),s("div",{class:p(["step-line",{active:e(i)>2}])},null,2),s("div",{class:p(["step",{active:e(i)>=3,completed:e(i)>3}])},[...t[8]||(t[8]=[s("div",{class:"step-number"},"3",-1),s("span",null,"التحقق",-1)])],2),s("div",{class:p(["step-line",{active:e(i)>3}])},null,2),s("div",{class:p(["step",{active:e(i)>=4}])},[...t[9]||(t[9]=[s("div",{class:"step-number"},"4",-1),s("span",null,"النتيجة",-1)])],2)]),e(i)===1?(n(),a("div",ss,[s("div",ts,[t[11]||(t[11]=s("div",{class:"form-icon"},[s("i",{class:"fas fa-hashtag"})],-1)),t[12]||(t[12]=s("h2",null,"أدخل رقم الحوالة",-1)),t[13]||(t[13]=s("p",null,"أدخل رقم الحوالة المكون من أرقام للاستعلام عنها",-1)),s("div",es,[O(s("input",{"onUpdate:modelValue":t[0]||(t[0]=d=>U(m)?m.value=d:null),type:"text",placeholder:"مثال: 123456",class:"input-large",onKeyup:D(I,["enter"])},null,544),[[q,e(m)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!e(m)||e(v),onClick:I},[e(v)?(n(),a("span",ns,[...t[10]||(t[10]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),y(" جاري البحث...",-1)])])):(n(),a("span",as,"بحث"))],8,ls)])])):c("",!0),e(i)===2?(n(),a("div",os,[s("div",is,[t[17]||(t[17]=s("div",{class:"form-icon success"},[s("i",{class:"fas fa-check"})],-1)),t[18]||(t[18]=s("h2",null,"تم العثور على الحوالة!",-1)),t[19]||(t[19]=s("p",null,"أدخل رقم هاتفك للتحقق من هويتك",-1)),s("div",rs,[(n(!0),a(F,null,M(e(C),(d,g)=>(n(),a("div",{key:g,class:"phone-item"},[t[14]||(t[14]=s("i",{class:"fas fa-phone"},null,-1)),s("span",null,[y(r(d.label)+": ",1),s("span",us,r(d.masked),1)])]))),128))]),s("div",ds,[O(s("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>U(_)?_.value=d:null),type:"tel",placeholder:"أدخل رقم هاتفك الكامل",class:"input-large",dir:"ltr",onKeyup:D(K,["enter"])},null,544),[[q,e(_)]])]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:!e(_)||e(v),onClick:K},[e(v)?(n(),a("span",cs,[...t[15]||(t[15]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),y(" جاري الإرسال...",-1)])])):(n(),a("span",vs,"إرسال رمز التحقق"))],8,ps),s("button",{class:"btn btn-outline btn-sm",onClick:L},[...t[16]||(t[16]=[s("i",{class:"fas fa-arrow-right"},null,-1),y(" رجوع ",-1)])])])])):c("",!0),e(i)===3?(n(),a("div",fs,[s("div",bs,[t[22]||(t[22]=s("div",{class:"form-icon"},[s("i",{class:"fab fa-whatsapp"})],-1)),t[23]||(t[23]=s("h2",null,"أدخل رمز التحقق",-1)),t[24]||(t[24]=s("p",null,"تم إرسال رمز مكون من 4 أرقام إلى واتساب",-1)),s("div",{class:p(["role-badge",e(h)])},[s("i",{class:p(e(h)==="sender"?"fas fa-paper-plane":"fas fa-inbox")},null,2),s("span",null,r(e(B)),1)],2),s("div",ys,[(n(),a(F,null,M(4,d=>O(s("input",{key:d,ref_for:!0,ref:g=>e($)[d-1]=g,"onUpdate:modelValue":g=>e(k)[d-1]=g,type:"text",maxlength:"1",class:"otp-input",onInput:g=>j(d-1),onKeydown:D(g=>E(d-1),["backspace"])},null,40,ms),[[q,e(k)[d-1]]])),64))]),s("button",{class:"btn btn-primary btn-lg full-width",disabled:e(k).join("").length!==4||e(v),onClick:R},[e(v)?(n(),a("span",gs,[...t[20]||(t[20]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),y(" جاري التحقق...",-1)])])):(n(),a("span",ks,"تحقق"))],8,_s),s("button",{class:"btn btn-outline btn-sm",onClick:L},[...t[21]||(t[21]=[s("i",{class:"fas fa-arrow-right"},null,-1),y(" رجوع ",-1)])])])])):c("",!0),e(i)===4?(n(),a("div",hs,[s("div",ws,[s("div",xs,[s("div",{class:p(["result-icon",e(o)?.status_class])},[...t[25]||(t[25]=[s("i",{class:"fas fa-receipt"},null,-1)])],2),t[26]||(t[26]=s("h2",null,"تفاصيل الحوالة",-1)),s("div",{class:p(["transfer-type-badge",e(b)])},[s("i",{class:p(e(b)==="internal"?"fas fa-home":"fas fa-globe")},null,2),s("span",null,r(e(V)),1)],2),s("div",{class:p(["status-badge",e(o)?.status_class])},r(e(o)?.status),3)]),s("div",Cs,[s("div",Ts,[t[27]||(t[27]=s("span",{class:"label"},"رقم الحوالة",-1)),s("span",Bs,r(e(o)?.code),1)]),s("div",$s,[t[28]||(t[28]=s("span",{class:"label"},"المرسل",-1)),s("span",Vs,r(e(o)?.sender_name),1)]),s("div",Os,[t[29]||(t[29]=s("span",{class:"label"},"المستلم",-1)),s("span",qs,r(e(o)?.receiver_name),1)]),e(b)==="internal"?(n(),a("div",Ds,[t[30]||(t[30]=s("span",{class:"label"},"المبلغ",-1)),s("span",Is,r(e(o)?.amount)+" "+r(e(o)?.currency),1)])):c("",!0),e(b)==="external"?(n(),a("div",Ks,[t[31]||(t[31]=s("span",{class:"label"},"المبلغ بالدينار الليبي",-1)),s("span",Ls,r(e(o)?.amount_lyd)+" LYD",1)])):c("",!0),e(b)==="external"?(n(),a("div",Ss,[t[32]||(t[32]=s("span",{class:"label"},"المبلغ الإجمالي",-1)),s("span",Ns,r(e(o)?.amount_total),1)])):c("",!0),s("div",Ps,[t[33]||(t[33]=s("span",{class:"label"},"تاريخ الإرسال",-1)),s("span",Us,r(e(o)?.insert_date),1)]),e(b)==="internal"&&e(o)?.branch_delivered?(n(),a("div",Fs,[t[34]||(t[34]=s("span",{class:"label"},"فرع الإرسال",-1)),s("span",Ms,r(e(o)?.branch_delivered),1)])):c("",!0),e(b)==="internal"&&e(o)?.branch_received?(n(),a("div",Rs,[t[35]||(t[35]=s("span",{class:"label"},"فرع الاستلام",-1)),s("span",js,r(e(o)?.branch_received),1)])):c("",!0),e(b)==="external"&&e(o)?.service_type?(n(),a("div",Es,[t[36]||(t[36]=s("span",{class:"label"},"نوع الخدمة",-1)),s("span",zs,r(e(o)?.service_type),1)])):c("",!0),e(b)==="external"&&e(o)?.country?(n(),a("div",Gs,[t[37]||(t[37]=s("span",{class:"label"},"الدولة",-1)),s("span",Ys,r(e(o)?.country),1)])):c("",!0)]),s("div",As,[s("button",{class:"btn btn-primary btn-lg",onClick:z},[...t[38]||(t[38]=[s("i",{class:"fas fa-search"},null,-1),y(" استعلام جديد ",-1)])]),N(S,{to:"/",class:"btn btn-outline btn-lg"},{default:P(()=>[...t[39]||(t[39]=[s("i",{class:"fas fa-home"},null,-1),y(" الرئيسية ",-1)])]),_:1})])])])):c("",!0),e(f)?(n(),a("div",Hs,[t[41]||(t[41]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),s("span",null,r(e(f)),1),s("button",{onClick:t[2]||(t[2]=d=>f.value="")},[...t[40]||(t[40]=[s("i",{class:"fas fa-times"},null,-1)])])])):c("",!0)])])}}}),Xs=J(Js,[["__scopeId","data-v-8f48f1b8"]]);export{Xs as default};
