import{h as T,D as A,y as L,z as K,i as o,k as j,c as r,a as s,l as k,f as G,A as J,B as u,d as i,C as p,m as t,H as S,F,r as I,t as y,n as N,b as R,w as H,e as Z,o as d,J as Q,_ as W}from"./BDj9wMSF.js";const X={class:"wu-page"},Y={class:"container"},ss={class:"wu-form-card"},es={class:"wu-form-row"},ts={class:"wu-form-group"},ls={class:"wu-form-group"},as={class:"wu-form-row"},ns={class:"wu-form-group"},os={class:"wu-form-group"},is={class:"wu-form-row"},us={class:"wu-form-group"},rs={class:"wu-form-group"},ds={class:"wu-file-wrapper"},ps={key:0,class:"wu-preview-container show"},cs=["src"],vs={class:"wu-form-row"},ws={class:"wu-form-group"},fs={class:"wu-form-group"},ms={class:"wu-form-row"},bs={class:"wu-form-group"},ys={key:0,class:"wu-shimmer-select"},_s=["value"],gs={class:"wu-form-group"},ks={class:"wu-form-row"},qs={class:"wu-form-group"},xs={class:"wu-amount-wrapper"},Vs={class:"wu-submit-wrapper"},hs=["disabled"],Us={key:0,class:"wu-modal-overlay show"},Cs={class:"wu-modal"},Bs={class:"wu-modal-body"},Ms={class:"wu-otp-wrapper"},Ss=["onUpdate:modelValue","onInput","onKeydown"],Fs={key:0,class:"wu-modal-error",style:{display:"block"}},Is=["disabled"],Ns={key:1,class:"wu-modal-overlay show"},Os={class:"wu-modal"},$s={class:"wu-modal-body",style:{"padding-top":"50px"}},Ds={class:"wu-tracking-code"},zs=T({__name:"transfer",setup(Es){A({title:"طلب تحويل ويسترن يونيون | الرحالة للصرافة",description:"قم بإرسال الأموال عبر ويسترن يونيون من ليبيا إلى أي مكان في العالم"});const{error:q}=L(),n=K({sender_name:"",sender_country:"",sender_city:"",national_id:"",sender_phone:"",receiver_name_ar:"",receiver_name_en:"",receiver_country:"",receiver_phone:"",amount:""}),_=o(null),g=o(""),U=o([]),x=o(!0),w=o(!1),C=o(""),V=o(!1),f=o(["","","",""]),h=o([]),m=o(""),b=o(!1),B=o(!1),M=o("");j(async()=>{x.value=!0;try{const a=await $fetch("/api/western-union/countries");U.value=a.countries}catch(a){console.error("Failed to load countries",a)}finally{x.value=!1}});const O=a=>{const c=a.target.files?.[0];if(c){if(c.size>5*1024*1024){q("حجم الصورة يجب أن يكون أقل من 5MB");return}_.value=c;const l=new FileReader;l.onload=v=>{g.value=v.target?.result},l.readAsDataURL(c)}},$=()=>{_.value=null,g.value="";const a=document.getElementById("passport_image");a&&(a.value="")},D=async()=>{if(!_.value){q("يرجى رفع صورة الجواز");return}w.value=!0;try{const a=new FormData;Object.entries(n).forEach(([c,l])=>{a.append(c,l)}),a.append("passport_image",_.value);const e=await $fetch("/api/western-union/transfer",{method:"POST",body:a});e.success&&(C.value=e.token,V.value=!0)}catch(a){q(a.data?.message||"حدث خطأ. يرجى المحاولة مرة أخرى.")}finally{w.value=!1}},z=a=>{f.value[a]&&a<3&&h.value[a+1]?.focus()},E=(a,e)=>{!f.value[a]&&a>0&&h.value[a-1]?.focus()},P=async()=>{const a=f.value.join("");if(a.length!==4){m.value="يرجى إدخال الرمز كاملاً";return}b.value=!0,m.value="";try{const e=await $fetch("/api/western-union/verify-otp",{method:"POST",body:{token:C.value,otp:a}});e.success&&(V.value=!1,M.value=e.tracking_code,B.value=!0)}catch(e){m.value=e.data?.message||"رمز التحقق غير صحيح"}finally{b.value=!1}};return(a,e)=>{const c=Z;return d(),r("div",X,[s("div",Y,[e[33]||(e[33]=G('<div class="wu-header" data-v-5cbf3515><div class="wu-badge" data-v-5cbf3515><i class="fas fa-money-bill-transfer" data-v-5cbf3515></i><span data-v-5cbf3515>ويسترن يونيون</span></div><h1 class="wu-title" data-v-5cbf3515>طلب تحويل <span class="gradient-text" data-v-5cbf3515>ويسترن يونيون</span></h1><p class="wu-subtitle" data-v-5cbf3515>يرجى ملء جميع البيانات بشكل صحيح لإتمام عملية التحويل</p></div>',1)),s("div",ss,[s("form",{onSubmit:J(D,["prevent"])},[e[30]||(e[30]=s("h3",{class:"wu-section-title"},[s("i",{class:"fas fa-user"}),s("span",null,"معلومات الراسل")],-1)),s("div",es,[s("div",ts,[e[10]||(e[10]=s("label",{class:"wu-label"},[i("اسم الراسل "),s("span",{class:"required"},"*")],-1)),u(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t(n).sender_name=l),type:"text",class:"wu-input",required:""},null,512),[[p,t(n).sender_name]])]),s("div",ls,[e[12]||(e[12]=s("label",{class:"wu-label"},[i("بلد الراسل "),s("span",{class:"required"},"*")],-1)),u(s("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>t(n).sender_country=l),class:"wu-select",required:""},[...e[11]||(e[11]=[s("option",{value:""},"اختر البلد",-1),s("option",{value:"ليبيا"},"ليبيا",-1)])],512),[[S,t(n).sender_country]])])]),s("div",as,[s("div",ns,[e[13]||(e[13]=s("label",{class:"wu-label"},[i("المدينة "),s("span",{class:"required"},"*")],-1)),u(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t(n).sender_city=l),type:"text",class:"wu-input",required:""},null,512),[[p,t(n).sender_city]])]),s("div",os,[e[14]||(e[14]=s("label",{class:"wu-label"},[i("الرقم الوطني (12 رقم) "),s("span",{class:"required"},"*")],-1)),u(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t(n).national_id=l),type:"text",class:"wu-input",maxlength:"12",pattern:"[0-9]{12}",required:""},null,512),[[p,t(n).national_id]])])]),s("div",is,[s("div",us,[e[15]||(e[15]=s("label",{class:"wu-label"},[i("رقم هاتف الراسل "),s("span",{class:"required"},"*")],-1)),u(s("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>t(n).sender_phone=l),type:"tel",class:"wu-input",placeholder:"مثال: 0912345678",required:""},null,512),[[p,t(n).sender_phone]]),e[16]||(e[16]=s("span",{class:"wu-hint"},"أرقام ليبيا أو مصر فقط - سيتم إرسال رمز التحقق عبر الواتساب",-1))]),s("div",rs,[e[19]||(e[19]=s("label",{class:"wu-label"},[i("صورة الجواز "),s("span",{class:"required"},"*")],-1)),s("div",ds,[s("input",{type:"file",class:"wu-file-input",id:"passport_image",onChange:O,accept:"image/*",required:""},null,32),e[17]||(e[17]=s("label",{for:"passport_image",class:"wu-file-label"},[s("i",{class:"fas fa-cloud-upload-alt"}),s("span",{class:"wu-file-text"},"اضغط لرفع صورة الجواز")],-1))]),e[20]||(e[20]=s("span",{class:"wu-hint"},"الصيغ المسموحة: JPG, PNG - الحد الأقصى: 5MB",-1)),t(g)?(d(),r("div",ps,[s("img",{src:t(g),class:"wu-preview-img",alt:"معاينة"},null,8,cs),s("button",{type:"button",class:"wu-preview-remove",onClick:$},[...e[18]||(e[18]=[s("i",{class:"fas fa-times"},null,-1)])])])):k("",!0)])]),e[31]||(e[31]=s("hr",{class:"wu-divider"},null,-1)),e[32]||(e[32]=s("h3",{class:"wu-section-title",style:{color:"#00B17A"}},[s("i",{class:"fas fa-user-check"}),s("span",null,"معلومات المستلم")],-1)),s("div",vs,[s("div",ws,[e[21]||(e[21]=s("label",{class:"wu-label"},[i("اسم المستلم بالكامل (بالعربي) "),s("span",{class:"required"},"*")],-1)),u(s("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>t(n).receiver_name_ar=l),type:"text",class:"wu-input",required:""},null,512),[[p,t(n).receiver_name_ar]])]),s("div",fs,[e[22]||(e[22]=s("label",{class:"wu-label"},[i("اسم المستلم بالكامل (بالإنجليزي) "),s("span",{class:"required"},"*")],-1)),u(s("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>t(n).receiver_name_en=l),type:"text",class:"wu-input",pattern:"[a-zA-Z\\s]+",required:""},null,512),[[p,t(n).receiver_name_en]]),e[23]||(e[23]=s("span",{class:"wu-hint"},"حروف إنجليزية فقط",-1))])]),s("div",ms,[s("div",bs,[e[26]||(e[26]=s("label",{class:"wu-label"},[i("بلد المستلم "),s("span",{class:"required"},"*")],-1)),t(x)?(d(),r("div",ys,[...e[24]||(e[24]=[s("div",{class:"shimmer-animation"},null,-1)])])):u((d(),r("select",{key:1,"onUpdate:modelValue":e[7]||(e[7]=l=>t(n).receiver_country=l),class:"wu-select",required:""},[e[25]||(e[25]=s("option",{value:""},"اختر البلد",-1)),(d(!0),r(F,null,I(t(U),l=>(d(),r("option",{key:l,value:l},y(l),9,_s))),128))],512)),[[S,t(n).receiver_country]])]),s("div",gs,[e[27]||(e[27]=s("label",{class:"wu-label"},[i("رقم هاتف المستلم "),s("span",{class:"required"},"*")],-1)),u(s("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>t(n).receiver_phone=l),type:"tel",class:"wu-input",required:""},null,512),[[p,t(n).receiver_phone]])])]),s("div",ks,[s("div",qs,[e[29]||(e[29]=s("label",{class:"wu-label"},[i("المبلغ بالدولار ($) "),s("span",{class:"required"},"*")],-1)),s("div",xs,[e[28]||(e[28]=s("span",{class:"wu-amount-prefix"},"$",-1)),u(s("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>t(n).amount=l),type:"number",class:"wu-input wu-amount-input",min:"1",step:"0.01",required:""},null,512),[[p,t(n).amount]])])])]),s("div",Vs,[s("button",{type:"submit",class:"wu-submit-btn",disabled:t(w)},[s("span",null,y(t(w)?"جاري الإرسال...":"التالي"),1),s("i",{class:N(t(w)?"fas fa-spinner fa-spin":"fas fa-arrow-left")},null,2)],8,hs)])],32)])]),t(V)?(d(),r("div",Us,[s("div",Cs,[e[35]||(e[35]=s("div",{class:"wu-modal-header"},[s("i",{class:"fas fa-shield-halved"}),s("h3",null,"التحقق من رقم الهاتف")],-1)),s("div",Bs,[e[34]||(e[34]=s("p",null,[i("تم إرسال رمز التحقق إلى رقم هاتفك عبر الواتساب"),s("br"),i("أدخل الرمز المكون من 4 أرقام")],-1)),s("div",Ms,[(d(),r(F,null,I(4,l=>u(s("input",{key:l,ref_for:!0,ref:v=>t(h)[l-1]=v,"onUpdate:modelValue":v=>t(f)[l-1]=v,type:"text",class:"wu-otp-input",maxlength:"1",onInput:v=>z(l-1),onKeydown:Q(v=>E(l-1),["backspace"])},null,40,Ss),[[p,t(f)[l-1]]])),64))]),t(m)?(d(),r("div",Fs,y(t(m)),1)):k("",!0),s("button",{type:"button",class:"wu-submit-btn",onClick:P,disabled:t(b)},[s("i",{class:N(t(b)?"fas fa-spinner fa-spin":"fas fa-check")},null,2),s("span",null,y(t(b)?"جاري التحقق...":"تأكيد"),1)],8,Is)])])])):k("",!0),t(B)?(d(),r("div",Ns,[s("div",Os,[s("div",$s,[e[37]||(e[37]=s("div",{class:"wu-success-icon"},[s("i",{class:"fas fa-check-circle"})],-1)),e[38]||(e[38]=s("h2",{style:{"margin-bottom":"10px"}},"تم تقديم طلبك بنجاح!",-1)),e[39]||(e[39]=s("p",null,"رقم التتبع الخاص بك:",-1)),s("div",Ds,y(t(M)),1),e[40]||(e[40]=s("p",{style:{"font-size":"0.9rem"}},"احتفظ بهذا الرقم لتتبع طلبك",-1)),R(c,{to:"/",class:"wu-submit-btn",style:{"margin-top":"20px","text-decoration":"none"}},{default:H(()=>[...e[36]||(e[36]=[s("i",{class:"fas fa-home"},null,-1),s("span",null,"العودة للرئيسية",-1)])]),_:1})])])])):k("",!0)])}}}),Ts=W(zs,[["__scopeId","data-v-5cbf3515"]]);export{Ts as default};
