import{_ as B}from"./ew78ZC_x.js";import{f as D,A as F,q as E,s as d,g as K,c as u,a as s,h as w,e as L,v as z,x as r,d as n,y as i,i as t,D as G,F as h,r as S,t as _,n as M,b as P,w as j,o as m,I as A}from"./C694Sa0J.js";import{u as R}from"./Bbe_COFG.js";import{_ as H}from"./DlAUqK2U.js";const J={class:"mg-page"},Q={class:"container"},W={class:"mg-form-card"},X={class:"mg-form-row"},Y={class:"mg-form-group"},Z={class:"mg-form-group"},ss={class:"mg-form-row"},es={class:"mg-form-group"},ts={class:"mg-form-group"},ls={class:"mg-form-row"},as={class:"mg-form-group"},os={class:"mg-amount-wrapper"},ns={class:"mg-form-group"},rs={key:0,class:"mg-shimmer-select"},is=["value"],ds={class:"mg-form-row"},us={class:"mg-form-group"},ms={class:"mg-form-group"},ps={class:"mg-form-row"},fs={class:"mg-form-group"},gs={class:"mg-form-group"},cs={class:"mg-form-row"},vs={class:"mg-form-group"},_s={class:"mg-form-group"},bs={class:"mg-form-row"},ys={class:"mg-form-group"},qs={class:"mg-form-group"},ws={class:"mg-form-row"},ks={class:"mg-form-group"},xs={class:"mg-submit-wrapper"},Vs=["disabled"],Us={key:0,class:"mg-modal-overlay show"},hs={class:"mg-modal"},Ss={class:"mg-modal-body"},Ms={class:"mg-otp-wrapper"},Cs=["onUpdate:modelValue","onInput","onKeydown"],Is={key:0,class:"mg-modal-error",style:{display:"block"}},$s=["disabled"],Ns={key:1,class:"mg-modal-overlay show"},Os={class:"mg-modal"},Ts={class:"mg-modal-body",style:{"padding-top":"50px"}},Bs={class:"mg-tracking-code"},Ds=D({__name:"transfer",setup(Fs){F({title:"طلب تحويل موني جرام | الرحالة للصرافة",description:"قم بإرسال الأموال عبر موني جرام MoneyGram من ليبيا إلى أي مكان في العالم"});const{error:C}=R(),a=E({sender_phone:"",sender_first_name:"",sender_father_name:"",sender_surname:"",amount:"",destination_country:"",id_number_type:"",id_issuance_place:"",sender_dob:"",sender_occupation:"",receiver_first_name:"",receiver_father_name:"",receiver_surname:"",receiver_birth_place:"",receiver_birth_date:""}),k=d([]),b=d(!0),p=d(!1),x=d(""),y=d(!1),f=d(["","","",""]),q=d([]),g=d(""),c=d(!1),V=d(!1),U=d("");K(async()=>{b.value=!0;try{const o=await $fetch("/api/moneygram/countries");o.success&&(k.value=o.countries)}catch(o){console.error("Failed to load countries",o)}finally{b.value=!1}});const I=async()=>{p.value=!0;try{const o=await $fetch("/api/moneygram/transfer",{method:"POST",body:a});o.success&&(x.value=o.token,y.value=!0)}catch(o){C(o.data?.message||"حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.")}finally{p.value=!1}},$=o=>{f.value[o]&&o<3&&q.value[o+1]?.focus()},N=(o,e)=>{!f.value[o]&&o>0&&q.value[o-1]?.focus()},O=async()=>{const o=f.value.join("");if(o.length!==4){g.value="يرجى إدخال الرمز كاملاً";return}c.value=!0,g.value="";try{const e=await $fetch("/api/moneygram/verify-otp",{method:"POST",body:{token:x.value,otp:o}});e.success&&(y.value=!1,U.value=e.tracking_code,V.value=!0)}catch(e){g.value=e.data?.message||"رمز التحقق غير صحيح"}finally{c.value=!1}};return(o,e)=>{const T=B;return m(),u("div",J,[s("div",Q,[e[37]||(e[37]=L('<div class="mg-header" data-v-59ff9c38><div class="mg-badge" data-v-59ff9c38><i class="fas fa-money-bill-transfer" data-v-59ff9c38></i><span data-v-59ff9c38>موني جرام</span></div><h1 class="mg-title" data-v-59ff9c38>طلب تحويل <span class="gradient-text mg-color" data-v-59ff9c38>MoneyGram</span></h1><p class="mg-subtitle" data-v-59ff9c38>يرجى ملء جميع البيانات الـ 15 المطلوبة بدقة لإتمام عملية التحويل</p></div>',1)),s("div",W,[s("form",{onSubmit:z(I,["prevent"])},[e[34]||(e[34]=s("h3",{class:"mg-section-title"},[s("i",{class:"fas fa-user"}),s("span",null,"معلومات الراسل (Sender Info)")],-1)),s("div",X,[s("div",Y,[e[15]||(e[15]=s("label",{class:"mg-label"},[n("رقم هاتف الراسل "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t(a).sender_phone=l),type:"tel",class:"mg-input",placeholder:"مثال: 0912345678",required:""},null,512),[[i,t(a).sender_phone]]),e[16]||(e[16]=s("span",{class:"mg-hint"},"أرقام ليبيا أو مصر فقط - للتحقق عبر الواتساب",-1))]),s("div",Z,[e[17]||(e[17]=s("label",{class:"mg-label"},[n("الاسم الأول "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>t(a).sender_first_name=l),type:"text",class:"mg-input",required:""},null,512),[[i,t(a).sender_first_name]])])]),s("div",ss,[s("div",es,[e[18]||(e[18]=s("label",{class:"mg-label"},[n("اسم الأب "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t(a).sender_father_name=l),type:"text",class:"mg-input",required:""},null,512),[[i,t(a).sender_father_name]])]),s("div",ts,[e[19]||(e[19]=s("label",{class:"mg-label"},[n("اللقب (الكنية) "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t(a).sender_surname=l),type:"text",class:"mg-input",required:""},null,512),[[i,t(a).sender_surname]])])]),s("div",ls,[s("div",as,[e[21]||(e[21]=s("label",{class:"mg-label"},[n("المبلغ بالدولار ($) "),s("span",{class:"required"},"*")],-1)),s("div",os,[e[20]||(e[20]=s("span",{class:"mg-amount-prefix"},"$",-1)),r(s("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>t(a).amount=l),type:"number",class:"mg-input mg-amount-input",min:"1",step:"0.01",required:""},null,512),[[i,t(a).amount]])])]),s("div",ns,[e[24]||(e[24]=s("label",{class:"mg-label"},[n("بلد الوجهة "),s("span",{class:"required"},"*")],-1)),t(b)?(m(),u("div",rs,[...e[22]||(e[22]=[s("div",{class:"shimmer-animation"},null,-1)])])):r((m(),u("select",{key:1,"onUpdate:modelValue":e[5]||(e[5]=l=>t(a).destination_country=l),class:"mg-select",required:""},[e[23]||(e[23]=s("option",{value:""},"اختر البلد",-1)),(m(!0),u(h,null,S(t(k),l=>(m(),u("option",{key:l,value:l},_(l),9,is))),128))],512)),[[G,t(a).destination_country]])])]),s("div",ds,[s("div",us,[e[25]||(e[25]=s("label",{class:"mg-label"},[n("رقم ونوع الهوية "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>t(a).id_number_type=l),type:"text",class:"mg-input",placeholder:"مثال: جواز سفر - D123456",required:""},null,512),[[i,t(a).id_number_type]])]),s("div",ms,[e[26]||(e[26]=s("label",{class:"mg-label"},[n("مكان إصدار الهوية "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>t(a).id_issuance_place=l),type:"text",class:"mg-input",required:""},null,512),[[i,t(a).id_issuance_place]])])]),s("div",ps,[s("div",fs,[e[27]||(e[27]=s("label",{class:"mg-label"},[n("تاريخ الميلاد "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>t(a).sender_dob=l),type:"date",class:"mg-input",required:""},null,512),[[i,t(a).sender_dob]])]),s("div",gs,[e[28]||(e[28]=s("label",{class:"mg-label"},[n("المهنة "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>t(a).sender_occupation=l),type:"text",class:"mg-input",required:""},null,512),[[i,t(a).sender_occupation]])])]),e[35]||(e[35]=s("hr",{class:"mg-divider"},null,-1)),e[36]||(e[36]=s("h3",{class:"mg-section-title mg-color"},[s("i",{class:"fas fa-user-check"}),s("span",null,"معلومات المستلم (Receiver Info)")],-1)),s("div",cs,[s("div",vs,[e[29]||(e[29]=s("label",{class:"mg-label"},[n("الاسم الأول للمستلم "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>t(a).receiver_first_name=l),type:"text",class:"mg-input",required:""},null,512),[[i,t(a).receiver_first_name]])]),s("div",_s,[e[30]||(e[30]=s("label",{class:"mg-label"},[n("اسم الأب للمستلم "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>t(a).receiver_father_name=l),type:"text",class:"mg-input",required:""},null,512),[[i,t(a).receiver_father_name]])])]),s("div",bs,[s("div",ys,[e[31]||(e[31]=s("label",{class:"mg-label"},[n("لقب المستلم "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>t(a).receiver_surname=l),type:"text",class:"mg-input",required:""},null,512),[[i,t(a).receiver_surname]])]),s("div",qs,[e[32]||(e[32]=s("label",{class:"mg-label"},[n("مكان ميلاد المستلم "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>t(a).receiver_birth_place=l),type:"text",class:"mg-input",required:""},null,512),[[i,t(a).receiver_birth_place]])])]),s("div",ws,[s("div",ks,[e[33]||(e[33]=s("label",{class:"mg-label"},[n("تاريخ ميلاد المستلم "),s("span",{class:"required"},"*")],-1)),r(s("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>t(a).receiver_birth_date=l),type:"date",class:"mg-input",required:""},null,512),[[i,t(a).receiver_birth_date]])])]),s("div",xs,[s("button",{type:"submit",class:"mg-submit-btn",disabled:t(p)},[s("span",null,_(t(p)?"جاري الإرسال...":"التالي"),1),s("i",{class:M(t(p)?"fas fa-spinner fa-spin":"fas fa-arrow-left")},null,2)],8,Vs)])],32)])]),t(y)?(m(),u("div",Us,[s("div",hs,[e[39]||(e[39]=s("div",{class:"mg-modal-header"},[s("i",{class:"fas fa-shield-halved"}),s("h3",null,"التحقق من رقم الهاتف")],-1)),s("div",Ss,[e[38]||(e[38]=s("p",null,[n("تم إرسال رمز التحقق إلى رقم هاتفك عبر الواتساب"),s("br"),n("أدخل الرمز المكون من 4 أرقام")],-1)),s("div",Ms,[(m(),u(h,null,S(4,l=>r(s("input",{key:l,ref_for:!0,ref:v=>t(q)[l-1]=v,"onUpdate:modelValue":v=>t(f)[l-1]=v,type:"text",class:"mg-otp-input",maxlength:"1",onInput:v=>$(l-1),onKeydown:A(v=>N(l-1),["backspace"])},null,40,Cs),[[i,t(f)[l-1]]])),64))]),t(g)?(m(),u("div",Is,_(t(g)),1)):w("",!0),s("button",{type:"button",class:"mg-submit-btn",onClick:O,disabled:t(c)},[s("i",{class:M(t(c)?"fas fa-spinner fa-spin":"fas fa-check")},null,2),s("span",null,_(t(c)?"جاري التحقق...":"تأكيد"),1)],8,$s)])])])):w("",!0),t(V)?(m(),u("div",Ns,[s("div",Os,[s("div",Ts,[e[41]||(e[41]=s("div",{class:"mg-success-icon"},[s("i",{class:"fas fa-check-circle"})],-1)),e[42]||(e[42]=s("h2",{style:{"margin-bottom":"10px"}},"تم تقديم طلبك بنجاح!",-1)),e[43]||(e[43]=s("p",null,"رقم التتبع الخاص بك:",-1)),s("div",Bs,_(t(U)),1),e[44]||(e[44]=s("p",{style:{"font-size":"0.9rem"}},"احتفظ بهذا الرقم لتتبع طلبك عبر صفحة التتبع",-1)),P(T,{to:"/",class:"mg-submit-btn",style:{"margin-top":"20px","text-decoration":"none"}},{default:j(()=>[...e[40]||(e[40]=[s("i",{class:"fas fa-home"},null,-1),s("span",null,"العودة للرئيسية",-1)])]),_:1})])])])):w("",!0)])}}}),Gs=H(Ds,[["__scopeId","data-v-59ff9c38"]]);export{Gs as default};
