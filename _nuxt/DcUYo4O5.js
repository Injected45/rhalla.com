import{h as T,D as E,y as D,i as u,c as n,a as t,f as K,l as b,m as e,B as g,C as x,E as N,t as i,n as m,F as C,r as S,o,J as U,_ as j}from"./BDj9wMSF.js";const F={class:"wu-page"},M={class:"container"},P={class:"wu-form-card"},z={key:0,class:"wu-step"},J={class:"wu-form-group"},L={key:0,class:"wu-error",style:{display:"block"}},R=["disabled"],q={key:1,class:"wu-step"},A={class:"wu-otp-wrapper"},G=["onUpdate:modelValue","onInput","onKeydown"],H={key:0,class:"wu-error",style:{display:"block","text-align":"center"}},Q={class:"wu-btn-group"},W=["disabled"],X={key:2,class:"wu-step"},Y={key:0,class:"table-wrapper"},Z={class:"wu-results-table"},tt={key:1,class:"wu-no-results"},st=T({__name:"track",setup(et){E({title:"تتبع طلب ويسترن يونيون | الرحالة للصرافة",description:"تتبع حالة طلب تحويل ويسترن يونيون الخاص بك"}),D();const r=u(1),d=u(""),p=u(""),v=u(!1),_=u(""),c=u(["","","",""]),k=u([]),f=u(""),y=u(!1),h=u([]),V=async()=>{if(!d.value){p.value="يرجى إدخال رقم الهاتف";return}v.value=!0,p.value="";try{const l=await $fetch("/api/western-union/track",{method:"POST",body:{phone:d.value}});l.success&&(_.value=l.token,r.value=2)}catch(l){p.value=l.data?.message||"حدث خطأ. يرجى المحاولة مرة أخرى."}finally{v.value=!1}},$=l=>{c.value[l]&&l<3&&k.value[l+1]?.focus()},B=(l,s)=>{!c.value[l]&&l>0&&k.value[l-1]?.focus()},I=async()=>{const l=c.value.join("");if(l.length!==4){f.value="يرجى إدخال الرمز كاملاً";return}y.value=!0,f.value="";try{const s=await $fetch("/api/western-union/verify-tracking-otp",{method:"POST",body:{token:_.value,otp:l}});s.success&&(h.value=s.transfers,r.value=3)}catch(s){f.value=s.data?.message||"رمز التحقق غير صحيح"}finally{y.value=!1}},O=()=>{r.value=1,d.value="",c.value=["","","",""],h.value=[],_.value=""};return(l,s)=>(o(),n("div",F,[t("div",M,[s[10]||(s[10]=K('<div class="wu-header" data-v-427d7e7e><div class="wu-badge" data-v-427d7e7e><i class="fas fa-search-location" data-v-427d7e7e></i><span data-v-427d7e7e>ويسترن يونيون</span></div><h1 class="wu-title" data-v-427d7e7e>تتبع <span class="gradient-text" data-v-427d7e7e>طلب التحويل</span></h1><p class="wu-subtitle" data-v-427d7e7e>أدخل رقم هاتفك للبحث عن طلباتك</p></div>',1)),t("div",P,[e(r)===1?(o(),n("div",z,[t("div",J,[s[2]||(s[2]=t("label",{class:"wu-label"},"رقم الهاتف",-1)),g(t("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>N(d)?d.value=a:null),type:"tel",class:"wu-input",placeholder:"أدخل رقم هاتفك"},null,512),[[x,e(d)]]),s[3]||(s[3]=t("p",{class:"wu-hint"},"نفس الرقم المستخدم في طلب التحويل",-1)),e(p)?(o(),n("div",L,i(e(p)),1)):b("",!0)]),t("button",{type:"button",class:"wu-btn wu-btn-primary",onClick:V,disabled:e(v)},[t("i",{class:m(e(v)?"fas fa-spinner fa-spin":"fas fa-search")},null,2),t("span",null,i(e(v)?"جاري البحث...":"بحث"),1)],8,R)])):b("",!0),e(r)===2?(o(),n("div",q,[s[5]||(s[5]=t("p",null,"تم إرسال رمز التحقق إلى رقم هاتفك عبر الواتساب",-1)),t("div",A,[(o(),n(C,null,S(4,a=>g(t("input",{key:a,ref_for:!0,ref:w=>e(k)[a-1]=w,"onUpdate:modelValue":w=>e(c)[a-1]=w,type:"text",class:"wu-otp-input",maxlength:"1",onInput:w=>$(a-1),onKeydown:U(w=>B(a-1),["backspace"])},null,40,G),[[x,e(c)[a-1]]])),64))]),e(f)?(o(),n("div",H,i(e(f)),1)):b("",!0),t("div",Q,[t("button",{type:"button",class:"wu-btn wu-btn-primary",onClick:I,disabled:e(y)},[t("i",{class:m(e(y)?"fas fa-spinner fa-spin":"fas fa-check")},null,2),t("span",null,i(e(y)?"جاري التحقق...":"تأكيد"),1)],8,W),t("button",{type:"button",class:"wu-btn wu-btn-outline",onClick:s[1]||(s[1]=a=>r.value=1)},[...s[4]||(s[4]=[t("span",null,"رجوع",-1)])])])])):b("",!0),e(r)===3?(o(),n("div",X,[s[9]||(s[9]=t("h3",{style:{"margin-bottom":"20px",display:"flex","align-items":"center","justify-content":"center",gap:"10px"}},[t("i",{class:"fas fa-list"}),t("span",null,"طلباتك")],-1)),e(h).length>0?(o(),n("div",Y,[t("table",Z,[s[6]||(s[6]=t("thead",null,[t("tr",null,[t("th",null,"رقم التتبع"),t("th",null,"اسم المستلم"),t("th",null,"المبلغ"),t("th",null,"الحالة"),t("th",null,"التاريخ")])],-1)),t("tbody",null,[(o(!0),n(C,null,S(e(h),a=>(o(),n("tr",{key:a.tracking_code},[t("td",null,i(a.tracking_code),1),t("td",null,i(a.receiver_name),1),t("td",null,"$"+i(a.amount),1),t("td",null,[t("span",{class:m(["wu-status-badge",a.status_class])},i(a.status_label),3)]),t("td",null,i(a.created_at),1)]))),128))])])])):(o(),n("div",tt,[...s[7]||(s[7]=[t("i",{class:"fas fa-inbox"},null,-1),t("p",null,"لا توجد طلبات",-1)])])),t("div",{class:"wu-btn-group",style:{"margin-top":"30px"}},[t("button",{type:"button",class:"wu-btn wu-btn-outline",onClick:O},[...s[8]||(s[8]=[t("i",{class:"fas fa-arrow-right"},null,-1),t("span",null,"بحث جديد",-1)])])])])):b("",!0)])])]))}}),lt=j(st,[["__scopeId","data-v-427d7e7e"]]);export{lt as default};
