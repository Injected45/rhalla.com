import{H as i,z as a}from"./yCz2Nzaa.js";const u=i("currency",{state:()=>({internalCurrencies:[],externalCurrencies:[],internalLastUpdated:"",externalLastUpdated:"",featuredCurrencies:[],featuredLastUpdated:"",loading:!1,error:null,hasFetched:!1}),actions:{async fetchCurrencies(t=!1){if(this.hasFetched&&!t)return;this.loading=!0,this.error=null;const n=a().public.useFeaturedCurrencies;try{if(n){const e=await $fetch("/api/currency-prices/featured");e.success&&(this.featuredCurrencies=e.data,this.featuredLastUpdated=e.last_updated,this.externalCurrencies=e.data,this.externalLastUpdated=e.last_updated)}else{const[e,r]=await Promise.all([$fetch("/api/currency-prices/internal"),$fetch("/api/currency-prices/external")]);e.success&&(this.internalCurrencies=e.data,this.internalLastUpdated=e.last_updated),r.success&&(this.externalCurrencies=r.data,this.externalLastUpdated=r.last_updated)}this.hasFetched=!0}catch(e){this.error="فشل في تحميل أسعار العملات",console.error("Currency fetch error:",e)}finally{this.loading=!1}},async refreshCurrencies(){await this.fetchCurrencies(!0)}},getters:{lastUpdated:t=>a().public.useFeaturedCurrencies?t.featuredLastUpdated:t.externalLastUpdated||t.internalLastUpdated}});export{u};
