import{_ as T}from"./Qzz9LfvA.js";import{g as I,y as S,x as q,l as d,c as o,a as s,e as E,q as y,j as t,d as K,s as h,v as w,z as L,t as r,n as _,F as C,r as $,b as U,w as j,o as i,E as z,_ as D}from"./B057cM1m.js";const F={class:"track-page"},M={class:"container"},P={key:0,class:"track-card"},R={class:"form-group"},A={class:"input-wrapper"},G=["disabled"],H={key:1,class:"track-card"},J={class:"otp-header"},Q={class:"otp-wrapper"},W=["onUpdate:modelValue","onInput","onKeydown"],X={key:0,class:"modal-error"},Y={class:"track-actions"},Z=["disabled"],ss={key:2,class:"results-container"},as={class:"results-header"},ts={key:0,class:"no-results"},es={key:1,class:"bookings-grid"},ns={class:"card-main"},ls={class:"card-info"},os={class:"info-value"},is={class:"card-info"},ds={class:"info-value tracking-code"},rs={class:"card-info"},us={class:"info-value"},cs=I({__name:"track",setup(ps){S({title:"تتبع حجز البطاقة | شركة الرحالة",description:"تتبع حالة حجز بطاقة الأغراض الشخصية الخاصة بك"});const m=q().public.apiBase,u=d(1),c=d(""),l=d(!1),g=d(""),p=d(["","","",""]),b=d([]),v=d(""),k=d([]),x=async()=>{if(c.value){l.value=!0;try{const n=await $fetch(`${m}/booking-cards/track`,{method:"POST",body:{phone:c.value}});n.success&&(g.value=n.token,u.value=2,p.value=["","","",""])}catch(n){alert(n.data?.message||"حدث خطأ. يرجى التأكد من رقم الهاتف.")}finally{l.value=!1}}},V=async()=>{const n=p.value.join("");if(n.length===4){l.value=!0,v.value="";try{const a=await $fetch(`${m}/booking-cards/verify-tracking-otp`,{method:"POST",body:{token:g.value,otp:n}});a.success&&(k.value=a.bookings,u.value=3)}catch{v.value="رمز التحقق غير صحيح"}finally{l.value=!1}}},B=n=>{p.value[n]&&n<3&&b.value[n+1]?.focus()},N=(n,a)=>{!p.value[n]&&n>0&&b.value[n-1]?.focus()};return(n,a)=>{const O=T;return i(),o("div",F,[s("div",M,[a[17]||(a[17]=E('<div class="page-header" data-v-9fa0732b><div class="header-badge" data-v-9fa0732b><i class="fas fa-search" data-v-9fa0732b></i><span data-v-9fa0732b>تتبع الحجز</span></div><h1 class="page-title" data-v-9fa0732b>تتبع حالة <span class="gradient-text" data-v-9fa0732b>حجز البطاقة</span></h1><p class="page-subtitle" data-v-9fa0732b>أدخل رقم هاتفك المسجل لتصلك رسالة تحقق وتعرض حالة حجزك</p></div>',1)),t(u)===1?(i(),o("div",P,[s("div",R,[a[4]||(a[4]=s("label",{class:"label"},[K("رقم الهاتف المسجل "),s("span",{class:"required"},"*")],-1)),s("div",A,[a[3]||(a[3]=s("i",{class:"fas fa-phone-flip"},null,-1)),h(s("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>L(c)?c.value=e:null),type:"tel",class:"input",placeholder:"مثال: 0912345678 أو 01012345678",required:""},null,512),[[w,t(c)]])]),a[5]||(a[5]=s("span",{class:"hint"},"يدعم الأرقام الليبية والمصرية - سيتم إرسال الرمز عبر الواتساب",-1))]),s("button",{class:"submit-btn",disabled:t(l),onClick:x},[s("span",null,r(t(l)?"جاري الإرسال...":"إرسال رمز التحقق"),1),s("i",{class:_(t(l)?"fas fa-spinner fa-spin":"fas fa-paper-plane")},null,2)],8,G)])):t(u)===2?(i(),o("div",H,[s("div",J,[a[6]||(a[6]=s("i",{class:"fas fa-shield-halved"},null,-1)),a[7]||(a[7]=s("h3",null,"أدخل رمز التحقق",-1)),s("p",null,"أرسلنا رمزاً إلى رقم الهاتف "+r(t(c)),1)]),s("div",Q,[(i(),o(C,null,$(4,e=>h(s("input",{key:e,ref_for:!0,ref:f=>t(b)[e-1]=f,"onUpdate:modelValue":f=>t(p)[e-1]=f,type:"text",class:"otp-input",maxlength:"1",onInput:f=>B(e-1),onKeydown:z(f=>N(e-1),["backspace"])},null,40,W),[[w,t(p)[e-1]]])),64))]),t(v)?(i(),o("div",X,r(t(v)),1)):y("",!0),s("div",Y,[s("button",{class:"submit-btn secondary",onClick:a[1]||(a[1]=e=>u.value=1)},[...a[8]||(a[8]=[s("i",{class:"fas fa-arrow-right"},null,-1),s("span",null,"رجوع",-1)])]),s("button",{class:"submit-btn",disabled:t(l),onClick:V},[s("span",null,r(t(l)?"جاري التحقق...":"عرض النتائج"),1),s("i",{class:_(t(l)?"fas fa-spinner fa-spin":"fas fa-check")},null,2)],8,Z)])])):t(u)===3?(i(),o("div",ss,[s("div",as,[a[10]||(a[10]=s("h3",null,"الحجوزات المرتبطة برقم الهاتف",-1)),s("button",{class:"track-again-btn",onClick:a[2]||(a[2]=e=>u.value=1)},[...a[9]||(a[9]=[s("i",{class:"fas fa-rotate-left"},null,-1),s("span",null,"بحث آخر",-1)])])]),t(k).length===0?(i(),o("div",ts,[a[12]||(a[12]=s("i",{class:"fas fa-folder-open"},null,-1)),a[13]||(a[13]=s("p",null,"لم يتم العثور على أي حجوزات مؤكدة لهذا الرقم",-1)),U(O,{to:"/booking-cards",class:"submit-btn"},{default:j(()=>[...a[11]||(a[11]=[s("span",null,"احجز الآن",-1)])]),_:1})])):(i(),o("div",es,[(i(!0),o(C,null,$(t(k),e=>(i(),o("div",{key:e.tracking_code,class:"booking-card"},[s("div",{class:_(["card-status",`status-${e.status_val}`])},r(e.status),3),s("div",ns,[s("div",ls,[a[14]||(a[14]=s("span",{class:"info-label"},"اسم صاحب الطلب",-1)),s("span",os,r(e.name),1)]),s("div",is,[a[15]||(a[15]=s("span",{class:"info-label"},"رقم التتبع",-1)),s("span",ds,r(e.tracking_code),1)]),s("div",rs,[a[16]||(a[16]=s("span",{class:"info-label"},"تاريخ الطلب",-1)),s("span",us,r(e.date),1)])])]))),128))]))])):y("",!0)])])}}}),ks=D(cs,[["__scopeId","data-v-9fa0732b"]]);export{ks as default};
