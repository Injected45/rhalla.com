import{f as M,A as E,z as K,s as i,c as l,a as t,e as N,h as y,i as e,x as w,y as C,B as U,t as u,n as k,F as $,r as B,o,I as j}from"./ZYNTWoyr.js";import{u as z}from"./DwYQhG6U.js";import{_ as D}from"./DlAUqK2U.js";const F={class:"mg-page"},G={class:"container"},P={class:"mg-form-card"},R={key:0,class:"mg-step"},A={class:"mg-form-group"},L={key:0,class:"mg-error",style:{display:"block"}},q=["disabled"],H={key:1,class:"mg-step"},J={class:"mg-otp-wrapper"},Q=["onUpdate:modelValue","onInput","onKeydown"],W={key:0,class:"mg-error",style:{display:"block","text-align":"center"}},X={class:"mg-btn-group"},Y=["disabled"],Z={key:2,class:"mg-step"},tt={key:0,class:"table-wrapper"},st={class:"mg-results-table"},et={key:1,class:"mg-no-results"},at=M({__name:"track",setup(nt){E({title:"تتبع طلب موني جرام | الرحالة للصرافة",description:"تتبع حالة طلب تحويل موني جرام MoneyGram الخاص بك بسهولة"}),z();const x=K().public.apiBase,r=i(1),c=i(""),d=i(""),m=i(!1),h=i(""),p=i(["","","",""]),_=i([]),v=i(""),f=i(!1),b=i([]),S=async()=>{if(!c.value){d.value="يرجى إدخال رقم الهاتف";return}m.value=!0,d.value="";try{const n=await $fetch(`${x}/moneygram/track`,{method:"POST",body:{phone:c.value}});n.success&&(h.value=n.token,r.value=2)}catch(n){d.value=n.data?.message||"لم يتم العثور على طلبات بهذا الرقم."}finally{m.value=!1}},V=n=>{p.value[n]&&n<3&&_.value[n+1]?.focus()},I=(n,s)=>{!p.value[n]&&n>0&&_.value[n-1]?.focus()},O=async()=>{const n=p.value.join("");if(n.length!==4){v.value="يرجى إدخال الرمز كاملاً";return}f.value=!0,v.value="";try{const s=await $fetch(`${x}/moneygram/verify-tracking-otp`,{method:"POST",body:{token:h.value,otp:n}});s.success&&(b.value=s.transfers,r.value=3)}catch(s){v.value=s.data?.message||"رمز التحقق غير صحيح"}finally{f.value=!1}},T=()=>{r.value=1,c.value="",p.value=["","","",""],b.value=[],h.value=""};return(n,s)=>(o(),l("div",F,[t("div",G,[s[10]||(s[10]=N('<div class="mg-header" data-v-a017225f><div class="mg-badge" data-v-a017225f><i class="fas fa-search-location" data-v-a017225f></i><span data-v-a017225f>موني جرام</span></div><h1 class="mg-title" data-v-a017225f>تتبع <span class="gradient-text mg-color" data-v-a017225f>طلب التحويل</span></h1><p class="mg-subtitle" data-v-a017225f>أدخل رقم هاتفك للبحث عن طلبات موني جرام الخاصة بك</p></div>',1)),t("div",P,[e(r)===1?(o(),l("div",R,[t("div",A,[s[2]||(s[2]=t("label",{class:"mg-label"},"رقم الهاتف",-1)),w(t("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>U(c)?c.value=a:null),type:"tel",class:"mg-input",placeholder:"أدخل رقم هاتفك"},null,512),[[C,e(c)]]),s[3]||(s[3]=t("p",{class:"mg-hint"},"نفس الرقم المستخدم في طلب التحويل (ليبيا أو مصر)",-1)),e(d)?(o(),l("div",L,u(e(d)),1)):y("",!0)]),t("button",{type:"button",class:"mg-btn mg-btn-primary",onClick:S,disabled:e(m)},[t("i",{class:k(e(m)?"fas fa-spinner fa-spin":"fas fa-search")},null,2),t("span",null,u(e(m)?"جاري البحث...":"بحث"),1)],8,q)])):y("",!0),e(r)===2?(o(),l("div",H,[s[5]||(s[5]=t("p",null,"تم إرسال رمز التحقق إلى رقم هاتفك عبر الواتساب",-1)),t("div",J,[(o(),l($,null,B(4,a=>w(t("input",{key:a,ref_for:!0,ref:g=>e(_)[a-1]=g,"onUpdate:modelValue":g=>e(p)[a-1]=g,type:"text",class:"mg-otp-input",maxlength:"1",onInput:g=>V(a-1),onKeydown:j(g=>I(a-1),["backspace"])},null,40,Q),[[C,e(p)[a-1]]])),64))]),e(v)?(o(),l("div",W,u(e(v)),1)):y("",!0),t("div",X,[t("button",{type:"button",class:"mg-btn mg-btn-primary",onClick:O,disabled:e(f)},[t("i",{class:k(e(f)?"fas fa-spinner fa-spin":"fas fa-check")},null,2),t("span",null,u(e(f)?"جاري التحقق...":"تأكيد"),1)],8,Y),t("button",{type:"button",class:"mg-btn mg-btn-outline",onClick:s[1]||(s[1]=a=>r.value=1)},[...s[4]||(s[4]=[t("span",null,"رجوع",-1)])])])])):y("",!0),e(r)===3?(o(),l("div",Z,[s[9]||(s[9]=t("h3",{style:{"margin-bottom":"20px",display:"flex","align-items":"center","justify-content":"center",gap:"10px"}},[t("i",{class:"fas fa-list"}),t("span",null,"طلباتك (MoneyGram)")],-1)),e(b).length>0?(o(),l("div",tt,[t("table",st,[s[6]||(s[6]=t("thead",null,[t("tr",null,[t("th",null,"رقم التتبع"),t("th",null,"اسم المستلم"),t("th",null,"المبلغ"),t("th",null,"الحالة"),t("th",null,"التاريخ")])],-1)),t("tbody",null,[(o(!0),l($,null,B(e(b),a=>(o(),l("tr",{key:a.tracking_code},[t("td",null,u(a.tracking_code),1),t("td",null,u(a.receiver_name),1),t("td",null,"$"+u(a.amount),1),t("td",null,[t("span",{class:k(["mg-status-badge","mg-status-"+a.status_class])},u(a.status),3)]),t("td",null,u(a.date),1)]))),128))])])])):(o(),l("div",et,[...s[7]||(s[7]=[t("i",{class:"fas fa-inbox"},null,-1),t("p",null,"لا توجد طلبات مرتبطة بهذا الرقم",-1)])])),t("div",{class:"mg-btn-group",style:{"margin-top":"30px"}},[t("button",{type:"button",class:"mg-btn mg-btn-outline",onClick:T},[...s[8]||(s[8]=[t("i",{class:"fas fa-arrow-right"},null,-1),t("span",null,"بحث جديد",-1)])])])])):y("",!0)])])]))}}),rt=D(at,[["__scopeId","data-v-a017225f"]]);export{rt as default};
