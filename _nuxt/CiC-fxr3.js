import{_ as T}from"./DIlvvCvj.js";import{g as I,y as S,x as q,l as r,c as o,a as s,e as E,q as g,j as e,d as K,s as h,v as w,z as L,t as d,n as k,F as C,r as $,b as U,w as j,o as i,E as z,_ as D}from"./BAAOFR7J.js";const F={class:"track-page"},M={class:"container"},P={key:0,class:"track-card"},R={class:"form-group"},A={class:"input-wrapper"},G=["disabled"],H={key:1,class:"track-card"},J={class:"otp-header"},Q={class:"otp-wrapper"},W=["onUpdate:modelValue","onInput","onKeydown"],X={key:0,class:"modal-error"},Y={class:"track-actions"},Z=["disabled"],ss={key:2,class:"results-container"},as={class:"results-header"},ts={key:0,class:"no-results"},es={key:1,class:"bookings-grid"},ns={class:"card-main"},ls={class:"card-info"},os={class:"info-value"},is={class:"card-info"},ds={class:"info-value"},rs={class:"card-info"},cs={class:"info-value tracking-code"},us={class:"card-info"},ps={class:"info-value"},fs=I({__name:"track",setup(vs){S({title:"تتبع حجز البطاقة | شركة الرحالة",description:"تتبع حالة حجز بطاقة الأغراض الشخصية الخاصة بك"});const m=q().public.apiBase,c=r(1),u=r(""),l=r(!1),y=r(""),p=r(["","","",""]),_=r([]),v=r(""),b=r([]),x=async()=>{if(u.value){l.value=!0;try{const n=await $fetch(`${m}/booking-cards/track`,{method:"POST",body:{phone:u.value}});n.success&&(y.value=n.token,c.value=2,p.value=["","","",""])}catch(n){alert(n.data?.message||"حدث خطأ. يرجى التأكد من رقم الهاتف.")}finally{l.value=!1}}},V=async()=>{const n=p.value.join("");if(n.length===4){l.value=!0,v.value="";try{const a=await $fetch(`${m}/booking-cards/verify-tracking-otp`,{method:"POST",body:{token:y.value,otp:n}});a.success&&(b.value=a.bookings,c.value=3)}catch{v.value="رمز التحقق غير صحيح"}finally{l.value=!1}}},B=n=>{p.value[n]&&n<3&&_.value[n+1]?.focus()},N=(n,a)=>{!p.value[n]&&n>0&&_.value[n-1]?.focus()};return(n,a)=>{const O=T;return i(),o("div",F,[s("div",M,[a[18]||(a[18]=E('<div class="page-header" data-v-7c4b3145><div class="header-badge" data-v-7c4b3145><i class="fas fa-search" data-v-7c4b3145></i><span data-v-7c4b3145>تتبع الحجز</span></div><h1 class="page-title" data-v-7c4b3145>تتبع حالة <span class="gradient-text" data-v-7c4b3145>حجز البطاقة</span></h1><p class="page-subtitle" data-v-7c4b3145>أدخل رقم هاتفك المسجل لتصلك رسالة تحقق وتعرض حالة حجزك</p></div>',1)),e(c)===1?(i(),o("div",P,[s("div",R,[a[4]||(a[4]=s("label",{class:"label"},[K("رقم الهاتف المسجل "),s("span",{class:"required"},"*")],-1)),s("div",A,[a[3]||(a[3]=s("i",{class:"fas fa-phone-flip"},null,-1)),h(s("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>L(u)?u.value=t:null),type:"tel",class:"input",placeholder:"مثال: 0912345678 أو 01012345678",required:""},null,512),[[w,e(u)]])]),a[5]||(a[5]=s("span",{class:"hint"},"يدعم الأرقام الليبية والمصرية - سيتم إرسال الرمز عبر الواتساب",-1))]),s("button",{class:"submit-btn",disabled:e(l),onClick:x},[s("span",null,d(e(l)?"جاري الإرسال...":"إرسال رمز التحقق"),1),s("i",{class:k(e(l)?"fas fa-spinner fa-spin":"fas fa-paper-plane")},null,2)],8,G)])):e(c)===2?(i(),o("div",H,[s("div",J,[a[6]||(a[6]=s("i",{class:"fas fa-shield-halved"},null,-1)),a[7]||(a[7]=s("h3",null,"أدخل رمز التحقق",-1)),s("p",null,"أرسلنا رمزاً إلى رقم الهاتف "+d(e(u)),1)]),s("div",Q,[(i(),o(C,null,$(4,t=>h(s("input",{key:t,ref_for:!0,ref:f=>e(_)[t-1]=f,"onUpdate:modelValue":f=>e(p)[t-1]=f,type:"text",class:"otp-input",maxlength:"1",onInput:f=>B(t-1),onKeydown:z(f=>N(t-1),["backspace"])},null,40,W),[[w,e(p)[t-1]]])),64))]),e(v)?(i(),o("div",X,d(e(v)),1)):g("",!0),s("div",Y,[s("button",{class:"submit-btn secondary",onClick:a[1]||(a[1]=t=>c.value=1)},[...a[8]||(a[8]=[s("i",{class:"fas fa-arrow-right"},null,-1),s("span",null,"رجوع",-1)])]),s("button",{class:"submit-btn",disabled:e(l),onClick:V},[s("span",null,d(e(l)?"جاري التحقق...":"عرض النتائج"),1),s("i",{class:k(e(l)?"fas fa-spinner fa-spin":"fas fa-check")},null,2)],8,Z)])])):e(c)===3?(i(),o("div",ss,[s("div",as,[a[10]||(a[10]=s("h3",null,"الحجوزات المرتبطة برقم الهاتف",-1)),s("button",{class:"track-again-btn",onClick:a[2]||(a[2]=t=>c.value=1)},[...a[9]||(a[9]=[s("i",{class:"fas fa-rotate-left"},null,-1),s("span",null,"بحث آخر",-1)])])]),e(b).length===0?(i(),o("div",ts,[a[12]||(a[12]=s("i",{class:"fas fa-folder-open"},null,-1)),a[13]||(a[13]=s("p",null,"لم يتم العثور على أي حجوزات مؤكدة لهذا الرقم",-1)),U(O,{to:"/booking-cards",class:"submit-btn"},{default:j(()=>[...a[11]||(a[11]=[s("span",null,"احجز الآن",-1)])]),_:1})])):(i(),o("div",es,[(i(!0),o(C,null,$(e(b),t=>(i(),o("div",{key:t.tracking_code,class:"booking-card"},[s("div",{class:k(["card-status",`status-${t.status_val}`])},d(t.status),3),s("div",ns,[s("div",ls,[a[14]||(a[14]=s("span",{class:"info-label"},"اسم صاحب الطلب",-1)),s("span",os,d(t.name),1)]),s("div",is,[a[15]||(a[15]=s("span",{class:"info-label"},"نوع الدفع",-1)),s("span",ds,d(t.payment_type),1)]),s("div",rs,[a[16]||(a[16]=s("span",{class:"info-label"},"رقم التتبع",-1)),s("span",cs,d(t.tracking_code),1)]),s("div",us,[a[17]||(a[17]=s("span",{class:"info-label"},"تاريخ الطلب",-1)),s("span",ps,d(t.date),1)])])]))),128))]))])):g("",!0)])])}}}),ms=D(fs,[["__scopeId","data-v-7c4b3145"]]);export{ms as default};
